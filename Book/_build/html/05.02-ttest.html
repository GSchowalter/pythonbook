

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>14. Comparing Two Means &#8212; Learning Statistics with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '05.02-ttest';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="15. Comparing several means" href="05.03-anova.html" />
    <link rel="prev" title="13. Categorical data analysis" href="05.01-chisquare.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="landingpage.html">
  
  
  
  
  
    <p class="title logo__title">Learning Statistics with Python</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="landingpage.html">
                    Learning Statistics with Python
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Part I. Background</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01.01-intro.html">1. Why do we learn statistics?</a></li>
<li class="toctree-l1"><a class="reference internal" href="01.02-studydesign.html">2. A brief introduction to research design</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part II. An Introduction to Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="02.01-getting_started_with_python.html">3. Getting Started with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="02.02-more_python_concepts.html">4. More Python Concepts</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part III. Working With Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="03.01-descriptives.html">5. Descriptive statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="03.02-drawing_graphs.html">6. Drawing Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="03.03-pragmatic_matters.html">7. Data Wrangling</a></li>
<li class="toctree-l1"><a class="reference internal" href="03.04-basic_programming.html">8. Basic Programming</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part IV. Statistical Theory</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="04.01-intro-to-probability.html">9. Statistical theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="04.02-probability.html">10. Introduction to Probability</a></li>
<li class="toctree-l1"><a class="reference internal" href="04.03-estimation.html">11. Estimating unknown quantities from a sample</a></li>
<li class="toctree-l1"><a class="reference internal" href="04.04-hypothesis-testing.html">12. Hypothesis Testing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part V. Statistical Tools</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="05.01-chisquare.html">13. Categorical data analysis</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">14. Comparing Two Means</a></li>
<li class="toctree-l1"><a class="reference internal" href="05.03-anova.html">15. Comparing several means</a></li>

<li class="toctree-l1"><a class="reference internal" href="05.04-regression.html">17. Linear regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="05.05-anova2.html">18. Factorial ANOVA</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part VI. Endings, Alternatives and Prospects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="06.01-bayes.html">19. Bayesian Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="06.02-epilogue.html">20. Epilogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">21. References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ethanweed/pythonbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ethanweed/pythonbook/issues/new?title=Issue%20on%20page%20%2F05.02-ttest.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/05.02-ttest.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Comparing Two Means</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-one-sample-z-test">14.1. The one-sample <span class="math notranslate nohighlight">\(z\)</span>-test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-inference-problem-that-the-test-addresses">14.1.1. The inference problem that the test addresses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-the-hypothesis-test">14.1.2. Constructing the hypothesis test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-worked-example-using-python">14.1.3. A worked example using Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-of-the-z-test">14.1.4. Assumptions of the <span class="math notranslate nohighlight">\(z\)</span>-test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-one-sample-t-test">14.2. The one-sample <span class="math notranslate nohighlight">\(t\)</span>-test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-the-t-test">14.2.1. Introducing the <span class="math notranslate nohighlight">\(t\)</span>-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#doing-the-test-in-python">14.2.2. Doing the test in Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-of-the-one-sample-t-test">14.2.3. Assumptions of the one sample <span class="math notranslate nohighlight">\(t\)</span>-test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-independent-samples-t-test-student-test">14.3. The independent samples <span class="math notranslate nohighlight">\(t\)</span>-test (Student test)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data">14.3.1. The data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-the-test">14.3.2. Introducing the test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-pooled-estimate-of-the-standard-deviation">14.3.3. A “pooled estimate” of the standard deviation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-same-pooled-estimate-described-differently">14.3.4. The same pooled estimate, described differently</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#completing-the-test">14.3.5. Completing the test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">14.3.6. Doing the test in Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#positive-and-negative-t-values">14.3.7. Positive and negative <span class="math notranslate nohighlight">\(t\)</span> values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-of-the-test">14.3.8. Assumptions of the test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-independent-samples-t-test-welch-test">14.4. The independent samples <span class="math notranslate nohighlight">\(t\)</span>-test (Welch test)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">14.4.1. Doing the test in Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">14.4.2. Assumptions of the test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-paired-samples-t-test">14.5. The paired-samples <span class="math notranslate nohighlight">\(t\)</span>-test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">14.5.1. The data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-paired-samples-t-test">14.5.2. What is the paired samples <span class="math notranslate nohighlight">\(t\)</span>-test?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">14.5.3. Doing the test in Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sided-tests">14.6. One sided tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#effect-size">14.7. Effect size</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohen-s-d-from-one-sample">14.7.1. Cohen’s <span class="math notranslate nohighlight">\(d\)</span> from one sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohen-s-d-from-a-student-t-test">14.7.2. Cohen’s <span class="math notranslate nohighlight">\(d\)</span> from a Student <span class="math notranslate nohighlight">\(t\)</span> test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohen-s-d-from-a-welch-test">14.7.3. Cohen’s <span class="math notranslate nohighlight">\(d\)</span> from a Welch test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohen-s-d-from-a-paired-samples-test">14.7.4. Cohen’s <span class="math notranslate nohighlight">\(d\)</span> from a paired-samples test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-the-normality-of-a-sample">14.8. Checking the normality of a sample</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qq-plots">14.8.1. QQ plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shapiro-wilk-tests">14.8.2. Shapiro-Wilk tests</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-non-normal-data-with-wilcoxon-tests">14.9. Testing non-normal data with Wilcoxon tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-sample-wilcoxon-test">14.9.1. Two sample Wilcoxon test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sample-wilcoxon-test">14.9.2. One sample Wilcoxon test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">14.10. Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="comparing-two-means">
<span id="ttest"></span><h1><span class="section-number">14. </span>Comparing Two Means<a class="headerlink" href="#comparing-two-means" title="Permalink to this heading">#</a></h1>
<p>In the previous chapter we covered the situation when your outcome variable is nominal scale and your predictor variable<a class="footnote-reference brackets" href="#note1" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> is also nominal scale. Lots of real world situations have that character, and so you’ll find that chi-square tests in particular are quite widely used. However, you’re much more likely to find yourself in a situation where your outcome variable is interval scale or higher, and what you’re interested in is whether the average value of the outcome variable is higher in one group or another. For instance, a psychologist might want to know if anxiety levels are higher among parents than non-parents, or if working memory capacity is reduced by listening to music (relative to not listening to music). In a medical context, we might want to know if a new drug increases or decreases blood pressure. An agricultural scientist might want to know whether adding phosphorus to Australian native plants will kill them.<a class="footnote-reference brackets" href="#note2" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> In all these situations, our outcome variable is a fairly continuous, interval or ratio scale variable; and our predictor is a binary “grouping” variable. In other words, we want to compare the means of the two groups.</p>
<p>The standard answer to the problem of comparing means is to use a <span class="math notranslate nohighlight">\(t\)</span>-test, of which there are several varieties depending on exactly what question you want to solve. As a consequence, the majority of this chapter focuses on different types of <span class="math notranslate nohighlight">\(t\)</span>-test: <a class="reference internal" href="#onesamplettest"><span class="std std-ref">one sample <span class="math notranslate nohighlight">\(t\)</span>-tests</span></a>, <a class="reference internal" href="#studentttest"><span class="std std-ref">student’s</span></a> and <a class="reference internal" href="#welchttest"><span class="std std-ref">welch’s</span></a>, and <a class="reference internal" href="#pairedsamplesttest"><span class="std std-ref">paired samples <span class="math notranslate nohighlight">\(t\)</span>-tests</span></a>. After that, we’ll talk a bit about <a class="reference internal" href="#cohensd"><span class="std std-ref">Cohen’s <span class="math notranslate nohighlight">\(d\)</span></span></a>, which is the standard measure of effect size for a <span class="math notranslate nohighlight">\(t\)</span>-test. The later sections of the chapter focus on the assumptions of the <span class="math notranslate nohighlight">\(t\)</span>-tests, and possible remedies if they are violated. However, before discussing any of these useful things, we’ll start with a discussion of the <span class="math notranslate nohighlight">\(z\)</span>-test.</p>
<section id="the-one-sample-z-test">
<h2><span class="section-number">14.1. </span>The one-sample <span class="math notranslate nohighlight">\(z\)</span>-test<a class="headerlink" href="#the-one-sample-z-test" title="Permalink to this heading">#</a></h2>
<p>In this section I’ll describe one of the most useless tests in all of statistics: the <strong><em><span class="math notranslate nohighlight">\(z\)</span>-test</em></strong>. Seriously – this test is almost never used in real life. Its only real purpose is that, when teaching statistics, it’s a very convenient stepping stone along the way towards the <span class="math notranslate nohighlight">\(t\)</span>-test, which is probably the most (over)used tool in all statistics.</p>
<section id="the-inference-problem-that-the-test-addresses">
<h3><span class="section-number">14.1.1. </span>The inference problem that the test addresses<a class="headerlink" href="#the-inference-problem-that-the-test-addresses" title="Permalink to this heading">#</a></h3>
<p>To introduce the idea behind the <span class="math notranslate nohighlight">\(z\)</span>-test, let’s use a simple example. A friend of mine, Dr Zeppo, grades his introductory statistics class on a curve. Let’s suppose that the average grade in his class is 67.5, and the standard deviation is 9.5. Of his many hundreds of students, it turns out that 20 of them also take psychology classes. Out of curiosity, I find myself wondering: do the psychology students tend to get the same grades as everyone else (i.e., mean 67.5) or do they tend to score higher or lower? He emails me the <code class="docutils literal notranslate"><span class="pre">zeppo.csv</span></code> file, which I use to pull up the <code class="docutils literal notranslate"><span class="pre">grades</span></code> of those students,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/zeppo.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>grades</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50</td>
    </tr>
    <tr>
      <th>1</th>
      <td>60</td>
    </tr>
    <tr>
      <th>2</th>
      <td>60</td>
    </tr>
    <tr>
      <th>3</th>
      <td>64</td>
    </tr>
    <tr>
      <th>4</th>
      <td>66</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>and calculate the mean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grades&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>72.3
</pre></div>
</div>
</div>
</div>
<p>Hm. It <em>might</em> be that the psychology students are scoring a bit higher than normal: that sample mean of <span class="math notranslate nohighlight">\(\bar{X} = 72.3\)</span> is a fair bit higher than the hypothesised population mean of <span class="math notranslate nohighlight">\(\mu = 67.5\)</span>, but on the other hand, a sample size of <span class="math notranslate nohighlight">\(N = 20\)</span> isn’t all that big. Maybe it’s pure chance.</p>
<p>To answer the question, it helps to be able to write down what it is that I think I know. Firstly, I know that the sample mean is <span class="math notranslate nohighlight">\(\bar{X} = 72.3\)</span>. If I’m willing to assume that the psychology students have the same standard deviation as the rest of the class, then I can say that the population standard deviation is <span class="math notranslate nohighlight">\(\sigma = 9.5\)</span>. I’ll also assume that since Dr Zeppo is grading to a curve, the psychology student grades are normally distributed.</p>
<p>Next, it helps to be clear about what I want to learn from the data. In this case, my research hypothesis relates to the <em>population</em> mean <span class="math notranslate nohighlight">\(\mu\)</span> for the psychology student grades, which is unknown. Specifically, I want to know if <span class="math notranslate nohighlight">\(\mu = 67.5\)</span> or not. Given that this is what I know, can we devise a hypothesis test to solve our problem? The data, along with the hypothesised distribution from which they are thought to arise, are shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-zeppo</span></code>. Not entirely obvious what the right answer is, is it? For this, we are going to need some statistics.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">67.5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mf">9.5</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grades&#39;</span><span class="p">])</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
 
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/352b91ab66babd2941a4ed01b83af95d11b82a5220f8a3cdd1139f00f61c40c6.png" src="_images/352b91ab66babd2941a4ed01b83af95d11b82a5220f8a3cdd1139f00f61c40c6.png" />
</div>
</div>
</section>
<section id="constructing-the-hypothesis-test">
<h3><span class="section-number">14.1.2. </span>Constructing the hypothesis test<a class="headerlink" href="#constructing-the-hypothesis-test" title="Permalink to this heading">#</a></h3>
<p>The first step in constructing a hypothesis test is to be clear about what the null and alternative hypotheses are. This isn’t too hard to do. Our null hypothesis, <span class="math notranslate nohighlight">\(H_0\)</span>, is that the true population mean <span class="math notranslate nohighlight">\(\mu\)</span> for psychology student grades is 67.5%; and our alternative hypothesis is that the population mean <em>isn’t</em> 67.5%. If we write this in mathematical notation, these hypotheses become,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ll}
H_0: &amp; \mu = 67.5 \\
H_1: &amp; \mu \neq 67.5
\end{array}
\end{split}\]</div>
<p>though to be honest this notation doesn’t add much to our understanding of the problem, it’s just a compact way of writing down what we’re trying to learn from the data. The null hypotheses <span class="math notranslate nohighlight">\(H_0\)</span> and the alternative hypothesis <span class="math notranslate nohighlight">\(H_1\)</span> for our test are both illustrated in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-ztesthyp</span></code>. In addition to providing us with these hypotheses, the scenario outlined above provides us with a fair amount of background knowledge that might be useful. Specifically, there are two special pieces of information that we can add:</p>
<ol class="arabic simple">
<li><p>The psychology grades are normally distributed.</p></li>
<li><p>The true standard deviation of these scores <span class="math notranslate nohighlight">\(\sigma\)</span> is known to be 9.5.</p></li>
</ol>
<p>For the moment, we’ll act as if these are absolutely trustworthy facts. In real life, this kind of absolutely trustworthy background knowledge doesn’t exist, and so if we want to rely on these facts we’ll just have make the <em>assumption</em> that these things are true. However, since these assumptions may or may not be warranted, we might need to check them. For now though, we’ll keep things simple.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">23.6</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span> <span class="n">mu</span><span class="o">-</span><span class="n">sigma</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">mu</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">23.6</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span> <span class="n">mu</span><span class="o">-</span><span class="n">sigma</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">mu</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>


<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mu = \mu_0$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mu \neq \mu_0$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span><span class="o">-</span><span class="n">sigma</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">23.6</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\sigma = \sigma_0$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span><span class="o">-</span><span class="n">sigma</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">23.6</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\sigma = \sigma_0$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(-1.2, 23.6, &#39;$\\sigma = \\sigma_0$&#39;)
</pre></div>
</div>
<img alt="_images/51e765f594e2b603963cbed1da90c5a23e3d7a6180adb0290e230213a9a961f9.png" src="_images/51e765f594e2b603963cbed1da90c5a23e3d7a6180adb0290e230213a9a961f9.png" />
</div>
</div>
<p>The next step is to figure out what we would be a good choice for a diagnostic test statistic; something that would help us discriminate between <span class="math notranslate nohighlight">\(H_0\)</span> and <span class="math notranslate nohighlight">\(H_1\)</span>. Given that the hypotheses all refer to the population mean <span class="math notranslate nohighlight">\(\mu\)</span>, you’d feel pretty confident that the sample mean <span class="math notranslate nohighlight">\(\bar{X}\)</span> would be a pretty useful place to start. What we could do, is look at the difference between the sample mean <span class="math notranslate nohighlight">\(\bar{X}\)</span> and the value that the null hypothesis predicts for the population mean. In our example, that would mean we calculate <span class="math notranslate nohighlight">\(\bar{X} - 67.5\)</span>. More generally, if we let <span class="math notranslate nohighlight">\(\mu_0\)</span> refer to the value that the null hypothesis claims is our population mean, then we’d want to calculate</p>
<div class="math notranslate nohighlight">
\[
\bar{X} - \mu_0
\]</div>
<p>If this quantity equals or is very close to 0, things are looking good for the null hypothesis. If this quantity is a long way away from 0, then it’s looking less likely that the null hypothesis is worth retaining. But how far away from zero should it be for us to reject <span class="math notranslate nohighlight">\(H_0\)</span>?</p>
<p>To figure that out, we need to be a bit more sneaky, and we’ll need to rely on those two pieces of background knowledge that I wrote down previously, namely that the raw data are normally distributed, and we know the value of the population standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>. If the null hypothesis is actually true, and the true mean is <span class="math notranslate nohighlight">\(\mu_0\)</span>, then these facts together mean that we know the complete population distribution of the data: a normal distribution with mean <span class="math notranslate nohighlight">\(\mu_0\)</span> and standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>. Adopting the notation from Section &#64;ref(normal), a statistician might write this as:</p>
<div class="math notranslate nohighlight">
\[
X \sim \mbox{Normal}(\mu_0,\sigma^2)
\]</div>
<p>Okay, if that’s true, then what can we say about the distribution of <span class="math notranslate nohighlight">\(\bar{X}\)</span>? Well, as we discussed earlier, the sampling distribution of the mean <span class="math notranslate nohighlight">\(\bar{X}\)</span> is also normal, and has mean <span class="math notranslate nohighlight">\(\mu\)</span>. But the standard deviation of this sampling distribution <span class="math notranslate nohighlight">\(\mbox{SE}({\bar{X}})\)</span>, which is called the <em>standard error of the mean</em>, is</p>
<div class="math notranslate nohighlight">
\[
\mbox{SE}({\bar{X}}) = \frac{\sigma}{\sqrt{N}}
\]</div>
<p>In other words, if the null hypothesis is true then the sampling distribution of the mean can be written as follows:</p>
<div class="math notranslate nohighlight">
\[
\bar{X} \sim \mbox{Normal}(\mu_0,\mbox{SE}({\bar{X}}))
\]</div>
<p>Now comes the trick. What we can do is convert the sample mean <span class="math notranslate nohighlight">\(\bar{X}\)</span> into a <a class="reference internal" href="03.01-descriptives.html#zcores"><span class="std std-ref">standard score</span></a>. This is conventionally written as <span class="math notranslate nohighlight">\(z\)</span>, but for now I’m going to refer to it as <span class="math notranslate nohighlight">\(z_{\bar{X}}\)</span>. (The reason for using this expanded notation is to help you remember that we’re calculating standardised version of a sample mean, <em>not</em> a standardised version of a single observation, which is what a <span class="math notranslate nohighlight">\(z\)</span>-score usually refers to). When we do so, the <span class="math notranslate nohighlight">\(z\)</span>-score for our sample mean is</p>
<div class="math notranslate nohighlight">
\[
z_{\bar{X}} = \frac{\bar{X} - \mu_0}{\mbox{SE}({\bar{X}})}
\]</div>
<p>or, equivalently</p>
<div class="math notranslate nohighlight">
\[
z_{\bar{X}} =  \frac{\bar{X} - \mu_0}{\sigma / \sqrt{N}}
\]</div>
<p>This <span class="math notranslate nohighlight">\(z\)</span>-score is our test statistic. The nice thing about using this as our test statistic is that like all <span class="math notranslate nohighlight">\(z\)</span>-scores, it has a standard normal distribution:</p>
<div class="math notranslate nohighlight">
\[
z_{\bar{X}} \sim \mbox{Normal}(0,1)
\]</div>
<p>(again, see the section on <a class="reference internal" href="03.01-descriptives.html#zcores"><span class="std std-ref">z-scores</span></a>) if you’ve forgotten why this is true). In other words, regardless of what scale the original data are on, the <span class="math notranslate nohighlight">\(z\)</span>-statistic iteself always has the same interpretation: it’s equal to the number of standard errors that separate the observed sample mean <span class="math notranslate nohighlight">\(\bar{X}\)</span> from the population mean <span class="math notranslate nohighlight">\(\mu_0\)</span> predicted by the null hypothesis. Better yet, regardless of what the population parameters for the raw scores actually are, the 5% critical regions for <span class="math notranslate nohighlight">\(z\)</span>-test are always the same, as illustrated in Figures &#64;ref(fig:ztest1) and &#64;ref(fig:ztest2).</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>


<span class="c1"># Two-sided test</span>
<span class="n">crit</span> <span class="o">=</span> <span class="mf">1.96</span>
<span class="n">p_lower</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&lt;</span><span class="n">crit</span><span class="o">*-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">p_upper</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&gt;</span><span class="n">crit</span><span class="p">]</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">p_lower</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_lower</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span><span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;///&quot;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">p_upper</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_upper</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span><span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;///&quot;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Two sided test&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.96</span><span class="p">,</span><span class="o">-</span><span class="mf">.03</span><span class="p">,</span> <span class="s1">&#39;-1.96&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.96</span><span class="p">,</span><span class="o">-</span><span class="mf">.03</span><span class="p">,</span> <span class="s1">&#39;1.96&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

<span class="c1"># One-sided test</span>
<span class="n">crit</span> <span class="o">=</span> <span class="mf">1.64</span>
<span class="n">p_upper</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="o">&gt;</span><span class="n">crit</span><span class="p">]</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;One sided test&quot;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.64</span><span class="p">,</span><span class="o">-</span><span class="mf">.03</span><span class="p">,</span> <span class="s1">&#39;1.64&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">p_upper</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">p_upper</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span><span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;///&quot;</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/9a4371c9440051e65cc1efffa2641deee018389cd7592ad610bba4eed49aaa42.png" src="_images/9a4371c9440051e65cc1efffa2641deee018389cd7592ad610bba4eed49aaa42.png" />
</div>
</div>
<p>And what this meant, way back in the days where people did all their statistics by hand, is that someone could publish a table like this:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p></p></th>
<th class="head text-center"><p></p></th>
<th class="head text-center"><p>critical z value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>desired a level</p></td>
<td class="text-center"><p>two-sided test</p></td>
<td class="text-center"><p>one-sided test</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>.1</p></td>
<td class="text-center"><p>1.644854</p></td>
<td class="text-center"><p>1.281552</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>.05</p></td>
<td class="text-center"><p>1.959964</p></td>
<td class="text-center"><p>1.644854</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>.01</p></td>
<td class="text-center"><p>2.575829</p></td>
<td class="text-center"><p>2.326348</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>.001</p></td>
<td class="text-center"><p>3.290527</p></td>
<td class="text-center"><p>3.090232</p></td>
</tr>
</tbody>
</table>
<p>which in turn meant that researchers could calculate their <span class="math notranslate nohighlight">\(z\)</span>-statistic by hand, and then look up the critical value in a text book.  That was an incredibly handy thing to be able to do back then, but it’s kind of unnecessary these days, since it’s trivially easy to do it with software like Python.</p>
</section>
<section id="a-worked-example-using-python">
<h3><span class="section-number">14.1.3. </span>A worked example using Python<a class="headerlink" href="#a-worked-example-using-python" title="Permalink to this heading">#</a></h3>
<p>Now, as I mentioned earlier, the <span class="math notranslate nohighlight">\(z\)</span>-test is almost never used in practice. However, the test is so incredibly simple that it’s really easy to do one manually. Let’s go back to the data from Dr Zeppo’s class. Having loaded the <code class="docutils literal notranslate"><span class="pre">grades</span></code> data, the first thing I need to do is calculate the sample mean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_mean</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;grades&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">sample_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>72.3
</pre></div>
</div>
</div>
</div>
<p>Then, I create variables corresponding to known population standard deviation (<span class="math notranslate nohighlight">\(\sigma = 9.5\)</span>), and the value of the population mean that the null hypothesis specifies (<span class="math notranslate nohighlight">\(\mu_0 = 67.5\)</span>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sd_true</span> <span class="o">=</span> <span class="mf">9.5</span>
<span class="n">mu_null</span> <span class="o">=</span> <span class="mf">67.5</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s also create a variable for the sample size. We could count up the number of observations ourselves, and type <code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">=</span> <span class="pre">20</span></code> at the command prompt, but counting is tedious and repetitive. Let’s get Python to do the tedious repetitive bit by using the <code class="docutils literal notranslate"><span class="pre">len()</span></code> function, which tells us how many elements there are in a vector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grades&#39;</span><span class="p">])</span>
<span class="n">N</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20
</pre></div>
</div>
</div>
</div>
<p>Next, let’s calculate the (true) standard error of the mean:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="n">sem_true</span> <span class="o">=</span> <span class="n">sd_true</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">sem_true</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.1242645786248002
</pre></div>
</div>
</div>
</div>
<p>And finally, we calculate our <span class="math notranslate nohighlight">\(z\)</span>-score:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_score</span> <span class="o">=</span> <span class="p">(</span><span class="n">sample_mean</span> <span class="o">-</span> <span class="n">mu_null</span><span class="p">)</span> <span class="o">/</span> <span class="n">sem_true</span>
<span class="n">z_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.259605535157681
</pre></div>
</div>
</div>
</div>
<p>At this point, we would traditionally look up the value 2.26 in our table of critical values. Our original hypothesis was two-sided (we didn’t really have any theory about whether psych students would be better or worse at statistics than other students) so our hypothesis test is two-sided (or two-tailed) also. Looking at the little table that I showed earlier, we can see that 2.26 is bigger than the critical value of 1.96 that would be required to be significant at <span class="math notranslate nohighlight">\(\alpha = .05\)</span>, but smaller than the value of 2.58 that would be required to be significant at a level of <span class="math notranslate nohighlight">\(\alpha = .01\)</span>. Therefore, we can conclude that we have a significant effect, which we might write up by saying something like this:</p>
<blockquote>
<div><p>With a mean grade of 73.2 in the sample of psychology students, and assuming a true population standard deviation of 9.5, we can conclude that the psychology students have significantly different statistics scores to the class average (<span class="math notranslate nohighlight">\(z = 2.26\)</span>, <span class="math notranslate nohighlight">\(N=20\)</span>, <span class="math notranslate nohighlight">\(p&lt;.05\)</span>).</p>
</div></blockquote>
<p>However, what if want an exact <span class="math notranslate nohighlight">\(p\)</span>-value? Well, back in the day, the tables of critical values were huge, and so you could look up your actual <span class="math notranslate nohighlight">\(z\)</span>-value, and find the smallest value of <span class="math notranslate nohighlight">\(\alpha\)</span> for which your data would be significant (which, as discussed earlier, is the very definition of a <span class="math notranslate nohighlight">\(p\)</span>-value). However, looking things up in books is tedious, and typing things into computers is awesome. So let’s do it using Python instead. Now, notice that the <span class="math notranslate nohighlight">\(\alpha\)</span> level of a <span class="math notranslate nohighlight">\(z\)</span>-test (or any other test, for that matter) defines the total area “under the curve” for the critical region, right? That is, if we set <span class="math notranslate nohighlight">\(\alpha = .05\)</span> for a two-sided test, then the critical region is set up such that the area under the curve for the critical region is <span class="math notranslate nohighlight">\(.05\)</span>. And, for the <span class="math notranslate nohighlight">\(z\)</span>-test, the critical value of 1.96 is chosen that way because the area in the lower tail (i.e., below <span class="math notranslate nohighlight">\(-1.96\)</span>) is exactly <span class="math notranslate nohighlight">\(.025\)</span> and the area under the upper tail (i.e., above <span class="math notranslate nohighlight">\(1.96\)</span>) is exactly <span class="math notranslate nohighlight">\(.025\)</span>. So, since our observed <span class="math notranslate nohighlight">\(z\)</span>-statistic is <span class="math notranslate nohighlight">\(2.26\)</span>, why not calculate the area under the curve below <span class="math notranslate nohighlight">\(-2.26\)</span> or above <span class="math notranslate nohighlight">\(2.26\)</span>? In Python we can calculate this using the <code class="docutils literal notranslate"><span class="pre">NormalDist().cdf()</span></code> method. For the lower tail:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statistics</span> <span class="kn">import</span> <span class="n">NormalDist</span>
<span class="n">lower_area</span> <span class="o">=</span> <span class="n">NormalDist</span><span class="p">()</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">z_score</span><span class="p">)</span>
<span class="n">lower_area</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.011922871882469877
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">NormalDist().cdf()</span></code> calculates the “cumulative density function” for a normal distribution. Translated to something slightly less opaque, this means that  <code class="docutils literal notranslate"><span class="pre">NormalDist().cdf()</span></code> gives us the probability that a random variable X will be less than or equal to a given value. In our case, the given value for the lower tail of the distribution was our z-score, <span class="math notranslate nohighlight">\(2.259\)</span>. So <code class="docutils literal notranslate"><span class="pre">NormalDist().cdf(-z_score)</span></code> gives us the probability that a random value draw from a normal distribution would be less than or equal to <span class="math notranslate nohighlight">\(-2.259\)</span>.</p>
<p>Of course, becauwe we didn’t have any particular theory about whether psychology students would do better worse than other students, our test should be two-tailed, that is, we are interested not only in the probability that a random value would be less than or equal to <span class="math notranslate nohighlight">\(-2.259\)</span>, but also whether it might fall in the upper tail, that is be greater than or equal to <span class="math notranslate nohighlight">\(-2.259\)</span>.</p>
<p>Since the normal distribution is symmetrical, the upper area under the curve is identical to the lower area, and we can simply add them together to find our exact <span class="math notranslate nohighlight">\(p\)</span>-value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lower_area</span> <span class="o">=</span> <span class="n">NormalDist</span><span class="p">()</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="o">-</span><span class="n">z_score</span><span class="p">)</span>
<span class="n">upper_area</span> <span class="o">=</span> <span class="n">lower_area</span>
<span class="n">p_value</span> <span class="o">=</span> <span class="n">lower_area</span> <span class="o">+</span> <span class="n">upper_area</span>
<span class="n">p_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.023845743764939753
</pre></div>
</div>
</div>
</div>
</section>
<section id="assumptions-of-the-z-test">
<span id="zassumptions"></span><h3><span class="section-number">14.1.4. </span>Assumptions of the <span class="math notranslate nohighlight">\(z\)</span>-test<a class="headerlink" href="#assumptions-of-the-z-test" title="Permalink to this heading">#</a></h3>
<p>As I’ve said before, all statistical tests make assumptions. Some tests make reasonable assumptions, while other tests do not. The test I’ve just described – the one sample <span class="math notranslate nohighlight">\(z\)</span>-test – makes three basic assumptions.  These are:</p>
<ul class="simple">
<li><p><em>Normality</em>. As usually described, the <span class="math notranslate nohighlight">\(z\)</span>-test assumes that the true population distribution is normal.<a class="footnote-reference brackets" href="#note3" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> is often pretty reasonable, and not only that, it’s an assumption that <a class="reference internal" href="#shapiro-wilk"><span class="std std-ref">we can check</span></a> if we feel worried about it.</p></li>
<li><p><em>Independence</em>. The second assumption of the test is that the observations in your data set are not correlated with each other, or related to each other in some funny way. This isn’t as easy to check statistically: it relies a bit on good experimetal design. An obvious (and stupid) example of something that violates this assumption is a data set where you “copy” the same observation over and over again in your data file: so you end up with a massive “sample size”, consisting of only one genuine observation. More realistically, you have to ask yourself if it’s really plausible to imagine that each observation is a completely random sample from the population that you’re interested in. In practice, this assumption is never met; but we try our best to design studies that minimise the problems of correlated data.</p></li>
<li><p><em>Known standard deviation</em>. The third assumption of the <span class="math notranslate nohighlight">\(z\)</span>-test is that the true standard deviation of the population is known to the researcher. This is just stupid. In no real world data analysis problem do you know the standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> of some population, but are completely ignorant about the mean <span class="math notranslate nohighlight">\(\mu\)</span>. In other words, this assumption is <em>always</em> wrong.</p></li>
</ul>
<p>In view of the stupidity of assuming that <span class="math notranslate nohighlight">\(\sigma\)</span> is known, let’s see if we can live without it. This takes us out of the dreary domain of the <span class="math notranslate nohighlight">\(z\)</span>-test, and into the magical kingdom of the <span class="math notranslate nohighlight">\(t\)</span>-test, with unicorns and fairies and leprechauns, and um…</p>
</section>
</section>
<section id="the-one-sample-t-test">
<span id="onesamplettest"></span><h2><span class="section-number">14.2. </span>The one-sample <span class="math notranslate nohighlight">\(t\)</span>-test<a class="headerlink" href="#the-one-sample-t-test" title="Permalink to this heading">#</a></h2>
<p>After some thought, I decided that it might not be safe to assume that the psychology student grades necessarily have the same standard deviation as the other students in Dr Zeppo’s class. After all, if I’m entertaining the hypothesis that they don’t have the same mean, then why should I believe that they absolutely have the same standard deviation? In view of this, I should really stop assuming that I know the true value of <span class="math notranslate nohighlight">\(\sigma\)</span>. This violates the assumptions of my <span class="math notranslate nohighlight">\(z\)</span>-test, so in one sense I’m back to square one. However, it’s not like I’m completely bereft of options. After all, I’ve still got my raw data, and those raw data give me an <em>estimate</em> of the population standard deviation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grades&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.520614752375916
</pre></div>
</div>
</div>
</div>
<p>In other words, while I can’t say that I know that <span class="math notranslate nohighlight">\(\sigma = 9.5\)</span>, I <em>can</em> say that <span class="math notranslate nohighlight">\(\hat\sigma = 9.52\)</span>.</p>
<p>Okay, cool. The obvious thing that you might think to do is run a <span class="math notranslate nohighlight">\(z\)</span>-test, but using the estimated standard deviation of 9.52 instead of relying on my assumption that the true standard deviation is 9.5. So, we could just type this new number into Python and out would come the answer. And you probably wouldn’t be surprised to hear that this would still give us a significant result. This approach is close, but it’s not <em>quite</em> correct. Because we are now relying on an <em>estimate</em> of the population standard deviation, we need to make some adjustment for the fact that we have some uncertainty about what the true population standard deviation actually is. Maybe our data are just a fluke … maybe the true population standard deviation is 11, for instance. But if that were actually true, and we ran the <span class="math notranslate nohighlight">\(z\)</span>-test assuming <span class="math notranslate nohighlight">\(\sigma=11\)</span>, then the result would end up being <em>non-significant</em>. That’s a problem, and it’s one we’re going to have to address.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>


<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">23.6</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span> <span class="n">mu</span><span class="o">-</span><span class="n">sigma</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">mu</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">23.6</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span> <span class="n">mu</span><span class="o">-</span><span class="n">sigma</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">mu</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>


<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mu = \mu_0$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mu \neq \mu_0$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span><span class="o">-</span><span class="n">sigma</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">23.6</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\sigma = ??$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mu</span><span class="o">-</span><span class="n">sigma</span> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">23.6</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\sigma = ??$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<img alt="_images/d805f7e19ab0f313513deea98dfecd770b80046b17263200df15eef13b9306c3.png" src="_images/d805f7e19ab0f313513deea98dfecd770b80046b17263200df15eef13b9306c3.png" />
</div>
</div>
<section id="introducing-the-t-test">
<h3><span class="section-number">14.2.1. </span>Introducing the <span class="math notranslate nohighlight">\(t\)</span>-test<a class="headerlink" href="#introducing-the-t-test" title="Permalink to this heading">#</a></h3>
<p>This ambiguity is annoying, and it was resolved in 1908 by a guy called William Sealy Gosset [&#64;Student1908], who was working as a chemist for the Guinness brewery at the time [see &#64;Box1987]. Because Guinness took a dim view of its employees publishing statistical analysis (apparently they felt it was a trade secret), he published the work under the pseudonym “A Student”, and to this day, the full name of the <span class="math notranslate nohighlight">\(t\)</span>-test is actually <strong><em>Student’s <span class="math notranslate nohighlight">\(t\)</span>-test</em></strong>. The key thing that Gosset figured out is how we should accommodate the fact that we aren’t completely sure what the true standard deviation is.<a class="footnote-reference brackets" href="#note4" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a> The answer is that it subtly changes the sampling distribution. In the <span class="math notranslate nohighlight">\(t\)</span>-test, our test statistic (now called a <span class="math notranslate nohighlight">\(t\)</span>-statistic) is calculated in exactly the same way I mentioned above. If our null hypothesis is that the true mean is <span class="math notranslate nohighlight">\(\mu\)</span>, but our sample has mean <span class="math notranslate nohighlight">\(\bar{X}\)</span> and our estimate of the population standard deviation is <span class="math notranslate nohighlight">\(\hat{\sigma}\)</span>, then our <span class="math notranslate nohighlight">\(t\)</span> statistic is:</p>
<div class="math notranslate nohighlight">
\[
t = \frac{\bar{X} - \mu}{\hat{\sigma}/\sqrt{N} }
\]</div>
<p>The only thing that has changed in the equation is that instead of using the known true value <span class="math notranslate nohighlight">\(\sigma\)</span>, we use the estimate <span class="math notranslate nohighlight">\(\hat{\sigma}\)</span>. And if this estimate has been constructed from <span class="math notranslate nohighlight">\(N\)</span> observations, then the sampling distribution turns into a <span class="math notranslate nohighlight">\(t\)</span>-distribution with <span class="math notranslate nohighlight">\(N-1\)</span> <strong><em>degrees of freedom</em></strong> (df). The <span class="math notranslate nohighlight">\(t\)</span> distribution is very similar to the normal distribution, but has “heavier” tails, as <a class="reference internal" href="04.02-probability.html#otherdists"><span class="std std-ref">discussed earlier</span></a>  and illustrated in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-ttestdist</span></code>. Notice, though, that as df gets larger, the <span class="math notranslate nohighlight">\(t\)</span>-distribution starts to look identical to the standard normal distribution. This is as it should be: if you have a sample size of <span class="math notranslate nohighlight">\(N = 70,000,000\)</span> then your “estimate” of the standard deviation would be pretty much perfect, right? So, you should expect that for large <span class="math notranslate nohighlight">\(N\)</span>, the <span class="math notranslate nohighlight">\(t\)</span>-test would behave exactly the same way as a <span class="math notranslate nohighlight">\(z\)</span>-test. And that’s exactly what happens!</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">variance</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">variance</span><span class="p">)</span>


<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y_norm</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>


<span class="c1"># t-distribution with 2 degrees of freedom</span>
<span class="n">y_t</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y_norm</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y_t</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># t-distribution with 10 degrees of freedom</span>
<span class="n">y_t</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y_norm</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y_t</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$df = 2$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.42</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$df = 10$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>


<span class="c1">#sns.despine()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/311ea2054c1f6ae68c1fc658ec3d86d088c7199029f402d8c2b96c8e0498fff0.png" src="_images/311ea2054c1f6ae68c1fc658ec3d86d088c7199029f402d8c2b96c8e0498fff0.png" />
</div>
</div>
</section>
<section id="doing-the-test-in-python">
<h3><span class="section-number">14.2.2. </span>Doing the test in Python<a class="headerlink" href="#doing-the-test-in-python" title="Permalink to this heading">#</a></h3>
<p>As you might expect, the mechanics of the <span class="math notranslate nohighlight">\(t\)</span>-test are almost identical to the mechanics of the <span class="math notranslate nohighlight">\(z\)</span>-test. So there’s not much point in going through the tedious exercise of showing you how to do the calculations using low level commands: it’s pretty much identical to the calculations that we did earlier, except that we use the estimated standard deviation (i.e., something like <code class="docutils literal notranslate"><span class="pre">se_est</span> <span class="pre">=</span> <span class="pre">statistics.stdev(grades)</span></code>), and then we test our hypothesis using the <span class="math notranslate nohighlight">\(t\)</span> distribution rather than the normal distribution. And so instead of going through the calculations in tedious detail for a second time, I’ll jump straight to showing you how <span class="math notranslate nohighlight">\(t\)</span>-tests are actually done in practice.</p>
<p>The situation with <span class="math notranslate nohighlight">\(t\)</span>-tests is very similar to the one we encountered with <a class="reference internal" href="05.01-chisquare.html#chisquare"><span class="std std-ref">chi-squared tests</span></a>. <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> includes a variety of methods for running different kinds of  <span class="math notranslate nohighlight">\(t\)</span>-tests, but the <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> package makes wraps these up and makes them easier (to my mind) to deal with. We’ll start with the <code class="docutils literal notranslate"><span class="pre">scipy</span></code> version for the one-sample <span class="math notranslate nohighlight">\(t\)</span>-test, so you can get a flavor for how <code class="docutils literal notranslate"><span class="pre">scipy</span></code> deals with <span class="math notranslate nohighlight">\(t\)</span>-tests, and then use the <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> alternatives for the rest.</p>
<p>To run a one-sample <span class="math notranslate nohighlight">\(t\)</span>-test with <code class="docutils literal notranslate"><span class="pre">scipy</span></code>, use the <code class="docutils literal notranslate"><span class="pre">ttest_1samp</span></code> method. It’s pretty straightforward to use: all you need to do is specify <code class="docutils literal notranslate"><span class="pre">a</span></code>, the variable containing the data, and <code class="docutils literal notranslate"><span class="pre">popmean</span></code>, the true population mean according to the null hypothesis. All you need to type is this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">ttest_1samp</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">ttest_1samp</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="n">grades</span><span class="p">,</span> <span class="n">popmean</span> <span class="o">=</span> <span class="mf">67.5</span><span class="p">)</span>
<span class="n">t</span><span class="p">,</span> <span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">ttest_1samp</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">ttest_1samp</span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="n">grades</span><span class="p">,</span> <span class="n">popmean</span> <span class="o">=</span> <span class="mf">67.5</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span>

<span class="ne">NameError</span>: name &#39;grades&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>So that seems straightforward enough. Our calculation resulted in a <span class="math notranslate nohighlight">\(t\)</span>-statistic of 2.54, and a <span class="math notranslate nohighlight">\(p\)</span>-value of 0.36. Now what do we <em>do</em> with this output? Well, since we’re pretending that we actually care about my toy example, we’re overjoyed to discover that the result is statistically significant (i.e. <span class="math notranslate nohighlight">\(p\)</span> value below .05), and we will probably want to report our result. We could report the result by saying something like this:</p>
<blockquote>
<div><p>With a mean grade of 72.3, the psychology students scored slightly higher than the average grade of 67.5 (<span class="math notranslate nohighlight">\(t(19) = 2.25\)</span>, <span class="math notranslate nohighlight">\(p&lt;.05\)</span>); the 95% confidence interval is [67.8, 76.8].</p>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(t(19)\)</span> is shorthand notation for a <span class="math notranslate nohighlight">\(t\)</span>-statistic that has 19 degrees of freedom.</p>
<p>As you will have already noticed, <code class="docutils literal notranslate"><span class="pre">ttest_1samp()</span></code> does not give us all the information included in the report above. A <span class="math notranslate nohighlight">\(t\)</span>-statistic, yes, and a <span class="math notranslate nohighlight">\(p\)</span>-value as well. But what about 95% confidence intervals? Where can we find those, and what about the degrees of freedom? In a better, simpler, kinder world, <code class="docutils literal notranslate"><span class="pre">ttest_1samp()</span></code> would provide all this information for us, and it’s honestly a bit shocking that it doesn’t. But sadly that is not the world we live in, and we have a bit more work to do.</p>
<p>First, off: degrees of freedom. In this case, that is not so difficult, because the degrees of freedom for a one-sample t-test is just <span class="math notranslate nohighlight">\(N-1\)</span>, so we can easily find that ourselves. We also already know how to find the sample mean of our data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>
<span class="n">degfree</span> <span class="o">=</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sample mean:&#39;</span><span class="p">,</span> <span class="n">sample_mean</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Degrees of freedom:&#39;</span><span class="p">,</span> <span class="n">degfree</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample mean: 72.3
Degrees of freedom: 19
</pre></div>
</div>
</div>
</div>
<p>Now at least we have the bare minimum of what is necessary to report our results. Still, it would be sweet if we could get those confidence intervals as well. <code class="docutils literal notranslate"><span class="pre">scipy</span></code> actually has all the tools we need, and why these are not just built into the <code class="docutils literal notranslate"><span class="pre">ttest_1samp()</span></code> method is beyond me. To find the confidence interval, we need to:</p>
<ol class="arabic simple">
<li><p>To set a confidence level</p></li>
<li><p>To know the sample mean</p></li>
<li><p>To know the degrees of freedom for the test</p></li>
<li><p>To know the standard error of the sample</p></li>
</ol>
<p>We discussed confidence intervals <a class="reference internal" href="04.03-estimation.html#ci"><span class="std std-ref">earlier</span></a>, and now is not the time to go into detail on this, so for now I’m just going to give you some code that you can use to find 95% confidence intervals for a one-sample t-test, so that we can get on with reporting our data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="n">confidence_level</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">degrees_freedom</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>
<span class="n">sample_standard_error</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>

<span class="n">confidence_interval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">confidence_level</span><span class="p">,</span> <span class="n">degrees_freedom</span><span class="p">,</span> <span class="n">sample_mean</span><span class="p">,</span> <span class="n">sample_standard_error</span><span class="p">)</span>
<span class="n">confidence_interval</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(67.84421513791415, 76.75578486208585)
</pre></div>
</div>
</div>
</div>
<p>Whew. Now at least we have everything we need for a full report of our results.</p>
<p>That said, it’s often the case that people don’t report the confidence interval, or do so using a much more compressed form than I’ve done here. For instance, it’s not uncommon to see the confidence interval included as part of the stat block, like this:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(t(19) = 2.25\)</span>, <span class="math notranslate nohighlight">\(p&lt;.05\)</span>, CI<span class="math notranslate nohighlight">\(_{95} = [67.8, 76.8]\)</span></p>
</div></blockquote>
<p>With that much jargon crammed into half a line, you know it must be really smart. <a class="footnote-reference brackets" href="#note5" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a></p>
<p>Having gone through all that, let’s take a look at the <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> command to achieve the same thing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pingouin</span> <span class="kn">import</span> <span class="n">ttest</span>
<span class="n">ttest</span><span class="p">(</span><span class="n">grades</span><span class="p">,</span> <span class="mf">67.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>2.254713</td>
      <td>19</td>
      <td>two-sided</td>
      <td>0.036145</td>
      <td>[67.84, 76.76]</td>
      <td>0.504169</td>
      <td>1.795</td>
      <td>0.571446</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Well. That was easy! All we need to do is feed the <code class="docutils literal notranslate"><span class="pre">ttest()</span></code> function from <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> with the data and the population mean under the null hypothesis, and <code class="docutils literal notranslate"><span class="pre">pinguoin</span></code> does the rest. We get a nice table with the <span class="math notranslate nohighlight">\(t\)</span>-value, the degrees of freedom, the <span class="math notranslate nohighlight">\(p\)</span>-value, 95% confidence interval, effect size (Cohen’s <span class="math notranslate nohighlight">\(d\)</span>), and a power estimate. BF10 refers to the “bayes factor”, which we will meet (briefly) in the section on <a class="reference internal" href="06.01-bayes.html#bayes"><span class="std std-ref">Bayesian statistics</span></a>.</p>
</section>
<section id="assumptions-of-the-one-sample-t-test">
<span id="ttestoneassumptions"></span><h3><span class="section-number">14.2.3. </span>Assumptions of the one sample <span class="math notranslate nohighlight">\(t\)</span>-test<a class="headerlink" href="#assumptions-of-the-one-sample-t-test" title="Permalink to this heading">#</a></h3>
<p>Okay, so what assumptions does the one-sample <span class="math notranslate nohighlight">\(t\)</span>-test make? Well, since the <span class="math notranslate nohighlight">\(t\)</span>-test is basically a <span class="math notranslate nohighlight">\(z\)</span>-test with the assumption of known standard deviation removed, you shouldn’t be surprised to see that it makes the same assumptions as the <span class="math notranslate nohighlight">\(z\)</span>-test, minus the one about the known standard deviation. That is</p>
<ul class="simple">
<li><p><em>Normality</em>. We’re still assuming that the the population distribution is normal<a class="footnote-reference brackets" href="#note-normality" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>.</p></li>
<li><p><em>Independence</em>. Once again, we have to assume that the observations in our sample are generated independently of one another. See the <a class="reference internal" href="#zassumptions"><span class="std std-ref">earlier discussion</span></a> about the <span class="math notranslate nohighlight">\(z\)</span>-test for specifics.</p></li>
</ul>
<p>Overall, these two assumptions aren’t terribly unreasonable, and as a consequence the one-sample <span class="math notranslate nohighlight">\(t\)</span>-test is pretty widely used in practice as a way of comparing a sample mean against a hypothesised population mean.</p>
</section>
</section>
<section id="the-independent-samples-t-test-student-test">
<span id="studentttest"></span><h2><span class="section-number">14.3. </span>The independent samples <span class="math notranslate nohighlight">\(t\)</span>-test (Student test)<a class="headerlink" href="#the-independent-samples-t-test-student-test" title="Permalink to this heading">#</a></h2>
<p>Although the one sample <span class="math notranslate nohighlight">\(t\)</span>-test has its uses, it’s not the most typical example of a <span class="math notranslate nohighlight">\(t\)</span>-test<a class="footnote-reference brackets" href="#note6" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a>. A much more common situation arises when you’ve got two different groups of observations. In psychology, this tends to correspond to two different groups of participants, where each group corresponds to a different condition in your study. For each person in the study, you measure some outcome variable of interest, and the research question that you’re asking is whether or not the two groups have the same population mean. This is the situation that the independent samples <span class="math notranslate nohighlight">\(t\)</span>-test is designed for.</p>
<section id="the-data">
<h3><span class="section-number">14.3.1. </span>The data<a class="headerlink" href="#the-data" title="Permalink to this heading">#</a></h3>
<p>Suppose we have 33 students taking Dr Harpo’s statistics lectures, and Dr Harpo doesn’t grade to a curve. Actually, Dr Harpo’s grading is a bit of a mystery, so we don’t really know anything about what the average grade is for the class as a whole. There are two tutors for the class, Anastasia and Bernadette. There are <span class="math notranslate nohighlight">\(N_1 = 15\)</span> students in Anastasia’s tutorials, and <span class="math notranslate nohighlight">\(N_2 = 18\)</span> in Bernadette’s tutorials. The research question I’m interested in is whether Anastasia or Bernadette is a better tutor, or if it doesn’t make much of a difference. Dr Harpo emails me the course grades, in the <code class="docutils literal notranslate"><span class="pre">harpo.csv</span></code> file. As usual, I’ll load the file and have a look at what variables it contains:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/harpo.csv&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>grade</th>
      <th>tutor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>65</td>
      <td>Anastasia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>72</td>
      <td>Bernadette</td>
    </tr>
    <tr>
      <th>2</th>
      <td>66</td>
      <td>Bernadette</td>
    </tr>
    <tr>
      <th>3</th>
      <td>74</td>
      <td>Anastasia</td>
    </tr>
    <tr>
      <th>4</th>
      <td>73</td>
      <td>Anastasia</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As we can see, there’s a single data frame with two variables, <code class="docutils literal notranslate"><span class="pre">grade</span></code> and <code class="docutils literal notranslate"><span class="pre">tutor</span></code>. The <code class="docutils literal notranslate"><span class="pre">grade</span></code> variable is a numeric vector, containing the grades for all <span class="math notranslate nohighlight">\(N = 33\)</span> students taking Dr Harpo’s class; the <code class="docutils literal notranslate"><span class="pre">tutor</span></code> variable is a factor that indicates who each student’s tutor was. The first five observations in this data set are shown above, and below is a nice little table with some summary statistics:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">harpo_summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span><span class="s1">&#39;students&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Anastasia</span><span class="se">\&#39;</span><span class="s1">s students&#39;</span><span class="p">,</span><span class="s1">&#39;Bernadette</span><span class="se">\&#39;</span><span class="s1">s students&#39;</span><span class="p">],</span>
     <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Anastasia&#39;</span><span class="p">][</span><span class="s1">&#39;grade&#39;</span><span class="p">]),</span> 
              <span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bernadette&#39;</span><span class="p">][</span><span class="s1">&#39;grade&#39;</span><span class="p">])],</span>
     <span class="s1">&#39;std dev&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">statistics</span><span class="o">.</span><span class="n">stdev</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Anastasia&#39;</span><span class="p">][</span><span class="s1">&#39;grade&#39;</span><span class="p">]),</span> 
                  <span class="n">statistics</span><span class="o">.</span><span class="n">stdev</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bernadette&#39;</span><span class="p">][</span><span class="s1">&#39;grade&#39;</span><span class="p">])],</span>
     <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Anastasia&#39;</span><span class="p">]),</span>
           <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bernadette&#39;</span><span class="p">])]</span>
    <span class="p">})</span>
<span class="n">harpo_summary</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>students</th>
      <th>mean</th>
      <th>std dev</th>
      <th>N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Anastasia's students</td>
      <td>74.533333</td>
      <td>8.998942</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bernadette's students</td>
      <td>69.055556</td>
      <td>5.774918</td>
      <td>18</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To give you a more detailed sense of what’s going on here, I’ve plotted histograms showing the distribution of grades for both tutors <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-harpohist</span></code>. Inspection of these histograms suggests that the students in Anastasia’s class may be getting slightly better grades on average, though they also seem a little more variable.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">Anastasia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Anastasia&#39;</span><span class="p">][</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>
<span class="n">Bernadette</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bernadette&#39;</span><span class="p">][</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">Anastasia</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">],</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">binwidth</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">Bernadette</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">],</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">binwidth</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Anastasia&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bernadette&#39;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/d0a0c384ff9483a801c5588153701c04e7a66218efd2fb4f1de69250381e4e03.png" src="_images/d0a0c384ff9483a801c5588153701c04e7a66218efd2fb4f1de69250381e4e03.png" />
</div>
</div>
<p><code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-ttestci</span></code> is a simpler plot showing the means and corresponding confidence intervals for both groups of students.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;tutor&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;grade&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/6f99cdaf355fd060163af6eab35d0c6df8828d92f5d31c9d6f5041152466c296.png" src="_images/6f99cdaf355fd060163af6eab35d0c6df8828d92f5d31c9d6f5041152466c296.png" />
</div>
</div>
</section>
<section id="introducing-the-test">
<h3><span class="section-number">14.3.2. </span>Introducing the test<a class="headerlink" href="#introducing-the-test" title="Permalink to this heading">#</a></h3>
<p>The <strong><em>independent samples <span class="math notranslate nohighlight">\(t\)</span>-test</em></strong> comes in two different forms, Student’s and Welch’s. The original Student <span class="math notranslate nohighlight">\(t\)</span>-test – which is the one I’ll describe in this section – is the simpler of the two, but relies on much more restrictive assumptions than the Welch <span class="math notranslate nohighlight">\(t\)</span>-test. Assuming for the moment that you want to run a two-sided test, the goal is to determine whether two “independent samples” of data are drawn from populations with the same mean (the null hypothesis) or different means (the alternative hypothesis). When we say “independent” samples, what we really mean here is that there’s no special relationship between observations in the two samples. This probably doesn’t make a lot of sense right now, but it will be clearer when we come to talk about the paired samples <span class="math notranslate nohighlight">\(t\)</span>-test later on. For now, let’s just point out that if we have an experimental design where participants are randomly allocated to one of two groups, and we want to compare the two groups’ mean performance on some outcome measure, then an independent samples <span class="math notranslate nohighlight">\(t\)</span>-test (rather than a paired samples <span class="math notranslate nohighlight">\(t\)</span>-test) is what we’re after.</p>
<p>Okay, so let’s let <span class="math notranslate nohighlight">\(\mu_1\)</span> denote the true population mean for group 1 (e.g., Anastasia’s students), and <span class="math notranslate nohighlight">\(\mu_2\)</span> will be the true population mean for group 2 (e.g., Bernadette’s students),<a class="footnote-reference brackets" href="#note7" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a> and as usual we’ll let <span class="math notranslate nohighlight">\(\bar{X}_1\)</span> and <span class="math notranslate nohighlight">\(\bar{X}_2\)</span> denote the observed sample means for both of these groups. Our null hypothesis states that the two population means are identical (<span class="math notranslate nohighlight">\(\mu_1 = \mu_2\)</span>) and the alternative to this is that they are not (<span class="math notranslate nohighlight">\(\mu_1 \neq \mu_2\)</span>). Written in mathematical-ese, this is…</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ll}
H_0: &amp; \mu_1 = \mu_2  \\
H_1: &amp; \mu_1 \neq \mu_2
\end{array}
\end{split}\]</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu1</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">mu1</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>


<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x1</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax2</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="s1">&#39;null hypothesis&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="s1">&#39;alternative hypothesis&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x16225f820&gt;
</pre></div>
</div>
<img alt="_images/21be2fe7713bbeb23915666a90b1bf721841581b4656ba51777e7ff7b1fa7d50.png" src="_images/21be2fe7713bbeb23915666a90b1bf721841581b4656ba51777e7ff7b1fa7d50.png" />
</div>
</div>
<p>To construct a hypothesis test that handles this scenario, we start by noting that if the null hypothesis is true, then the difference between the population means is <em>exactly</em> zero,
<span class="math notranslate nohighlight">\(\mu_1 - \mu_2 = 0\)</span>
As a consequence, a diagnostic test statistic will be based on the difference between the two sample means. Because if the null hypothesis is true, then we’d expect</p>
<div class="math notranslate nohighlight">
\[
\bar{X}_1 - \bar{X}_2
\]</div>
<p>to be <em>pretty close</em> to zero. However, just like we saw with our one-sample tests (i.e., the one-sample <span class="math notranslate nohighlight">\(z\)</span>-test and the one-sample <span class="math notranslate nohighlight">\(t\)</span>-test) we have to be precise about exactly <em>how close</em> to zero this difference should be. And the solution to the problem is more or less the same one: we calculate a standard error estimate (SE), just like last time, and then divide the difference between means by this estimate. So our <strong><em><span class="math notranslate nohighlight">\(t\)</span>-statistic</em></strong> will be of the form</p>
<div class="math notranslate nohighlight">
\[
t = \frac{\bar{X}_1 - \bar{X}_2}{\mbox{SE}}
\]</div>
<p>We just need to figure out what this standard error estimate actually is. This is a bit trickier than was the case for either of the two tests we’ve looked at so far, so we need to go through it a lot more carefully to understand how it works.</p>
</section>
<section id="a-pooled-estimate-of-the-standard-deviation">
<h3><span class="section-number">14.3.3. </span>A “pooled estimate” of the standard deviation<a class="headerlink" href="#a-pooled-estimate-of-the-standard-deviation" title="Permalink to this heading">#</a></h3>
<p>In the original “Student <span class="math notranslate nohighlight">\(t\)</span>-test”, we make the assumption that the two groups have the same population standard deviation: that is, regardless of whether the population means are the same, we assume that the population standard deviations are identical, <span class="math notranslate nohighlight">\(\sigma_1 = \sigma_2\)</span>. Since we’re assuming that the two standard deviations are the same, we drop the subscripts and refer to both of them as <span class="math notranslate nohighlight">\(\sigma\)</span>. How should we estimate this? How should we construct a single estimate of a standard deviation when we have two samples? The answer is, basically, we average them. Well, sort of. Actually, what we do is take a <em>weighed</em> average of the <em>variance</em> estimates, which we use as our <strong><em>pooled estimate of the variance</em></strong>. The weight assigned to each sample is equal to the number of observations in that sample, minus 1. Mathematically, we can write this as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
w_1 &amp;=&amp; N_1 - 1\\
w_2 &amp;=&amp; N_2 - 1
\end{array}
\end{split}\]</div>
<p>Now that we’ve assigned weights to each sample, we calculate the pooled estimate of the variance by taking the weighted average of the two variance estimates, <span class="math notranslate nohighlight">\({\hat\sigma_1}^2\)</span> and <span class="math notranslate nohighlight">\({\hat\sigma_2}^2\)</span></p>
<div class="math notranslate nohighlight">
\[
\hat\sigma^2_p = \frac{w_1 {\hat\sigma_1}^2 + w_2 {\hat\sigma_2}^2}{w_1 + w_2}
\]</div>
<p>Finally, we convert the pooled variance estimate to a pooled standard deviation estimate, by taking the square root. This gives us the following formula for <span class="math notranslate nohighlight">\(\hat\sigma_p\)</span>,</p>
<div class="math notranslate nohighlight">
\[
\hat\sigma_p = \sqrt{\frac{w_1 {\hat\sigma_1}^2 + w_2 {\hat\sigma_2}^2}{w_1 + w_2}}
\]</div>
<p>And if you mentally substitute <span class="math notranslate nohighlight">\(w_1 = N_1 -1\)</span> and <span class="math notranslate nohighlight">\(w_2 = N_2 -1\)</span> into this equation you get a very ugly looking formula; a very ugly formula that actually seems to be the “standard” way of describing the pooled standard deviation estimate. It’s not my favourite way of thinking about pooled standard deviations, however.<a class="footnote-reference brackets" href="#note8" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a></p>
</section>
<section id="the-same-pooled-estimate-described-differently">
<h3><span class="section-number">14.3.4. </span>The same pooled estimate, described differently<a class="headerlink" href="#the-same-pooled-estimate-described-differently" title="Permalink to this heading">#</a></h3>
<p>I prefer to think about it like this. Our data set actually corresponds to a set of <span class="math notranslate nohighlight">\(N\)</span> observations, which are sorted into two groups. So let’s use the notation <span class="math notranslate nohighlight">\(X_{ik}\)</span> to refer to the grade received by the <span class="math notranslate nohighlight">\(i\)</span>-th student in the <span class="math notranslate nohighlight">\(k\)</span>-th tutorial group: that is, <span class="math notranslate nohighlight">\(X_{11}\)</span> is the grade received by the first student in Anastasia’s class, <span class="math notranslate nohighlight">\(X_{21}\)</span> is her second student, and so on. And we have two separate group means <span class="math notranslate nohighlight">\(\bar{X}_1\)</span> and <span class="math notranslate nohighlight">\(\bar{X}_2\)</span>, which we could “generically” refer to using the notation <span class="math notranslate nohighlight">\(\bar{X}_k\)</span>, i.e., the mean grade for the <span class="math notranslate nohighlight">\(k\)</span>-th tutorial group. So far, so good. Now, since every single student falls into one of the two tutorials, then we can describe their deviation from the group mean as the difference</p>
<div class="math notranslate nohighlight">
\[
X_{ik} - \bar{X}_k
\]</div>
<p>So why not just use these deviations (i.e., the extent to which each student’s grade differs from the mean grade in their tutorial?) Remember, a variance is just the average of a bunch of squared deviations, so let’s do that. Mathematically, we could write it like this:</p>
<div class="math notranslate nohighlight">
\[
\frac{\sum_{ik} \left( X_{ik} - \bar{X}_k \right)^2}{N}
\]</div>
<p>where the notation “<span class="math notranslate nohighlight">\(\sum_{ik}\)</span>” is a lazy way of saying “calculate a sum by looking at all students in all tutorials”, since each “<span class="math notranslate nohighlight">\(ik\)</span>” corresponds to one student.^[A more correct notation will be introduced in chapter on ANOVA(anova).] But, as we saw in the chapter on <a class="reference internal" href="04.03-estimation.html#estimation"><span class="std std-ref">estimation</span></a>, calculating the variance by dividing by <span class="math notranslate nohighlight">\(N\)</span> produces a biased estimate of the population variance. And previously, we needed to divide by <span class="math notranslate nohighlight">\(N-1\)</span> to fix this. However, as I mentioned at the time, the reason why this bias exists is because the variance estimate relies on the sample mean; and to the extent that the sample mean isn’t equal to the population mean, it can systematically bias our estimate of the variance. But this time we’re relying on <em>two</em> sample means! Does this mean that we’ve got more bias? Yes, yes it does. And does this mean we now need to divide by <span class="math notranslate nohighlight">\(N-2\)</span> instead of <span class="math notranslate nohighlight">\(N-1\)</span>, in order to calculate our pooled variance estimate? Why, yes…</p>
<div class="math notranslate nohighlight">
\[
\hat\sigma^2_p = \frac{\sum_{ik} \left( X_{ik} - \bar{X}_k \right)^2}{N -2}
\]</div>
<p>Oh, and if you take the square root of this then you get <span class="math notranslate nohighlight">\(\hat{\sigma}_p\)</span>, the pooled standard deviation estimate. In other words, the pooled standard deviation calculation is nothing special: it’s not terribly different to the regular standard deviation calculation.</p>
</section>
<section id="completing-the-test">
<span id="indsamplesttest-formula"></span><h3><span class="section-number">14.3.5. </span>Completing the test<a class="headerlink" href="#completing-the-test" title="Permalink to this heading">#</a></h3>
<p>Regardless of which way you want to think about it, we now have our pooled estimate of the standard deviation. From now on, I’ll drop the silly <span class="math notranslate nohighlight">\(p\)</span> subscript, and just refer to this estimate as <span class="math notranslate nohighlight">\(\hat\sigma\)</span>. Great. Let’s now go back to thinking about the bloody hypothesis test, shall we? Our whole reason for calculating this pooled estimate was that we knew it would be helpful when calculating our <em>standard error</em> estimate. But, standard error of <em>what</em>? In the one-sample <span class="math notranslate nohighlight">\(t\)</span>-test, it was the standard error of the sample mean, <span class="math notranslate nohighlight">\(\mbox{SE}({\bar{X}})\)</span>, and since <span class="math notranslate nohighlight">\(\mbox{SE}({\bar{X}}) = \sigma / \sqrt{N}\)</span> that’s what the denominator of our <span class="math notranslate nohighlight">\(t\)</span>-statistic looked like. This time around, however, we have <em>two</em> sample means. And what we’re interested in, specifically, is the the difference between the two <span class="math notranslate nohighlight">\(\bar{X}_1 - \bar{X}_2\)</span>. As a consequence, the standard error that we need to divide by is in fact the <strong><em>standard error of the difference</em></strong> between means. As long as the two variables really do have the same standard deviation, then our estimate for the standard error is</p>
<div class="math notranslate nohighlight">
\[
\mbox{SE}({\bar{X}_1 - \bar{X}_2}) = \hat\sigma \sqrt{\frac{1}{N_1} + \frac{1}{N_2}}
\]</div>
<p>and our <span class="math notranslate nohighlight">\(t\)</span>-statistic is therefore</p>
<div class="math notranslate nohighlight">
\[
t = \frac{\bar{X}_1 - \bar{X}_2}{\mbox{SE}({\bar{X}_1 - \bar{X}_2})}
\]</div>
<p>Just as we saw with our one-sample test, the sampling distribution of this <span class="math notranslate nohighlight">\(t\)</span>-statistic is a <span class="math notranslate nohighlight">\(t\)</span>-distribution (shocking, isn’t it?) as long as the null hypothesis is true, and all of the assumptions of the test are met. The degrees of freedom, however, is slightly different. As usual, we can think of the degrees of freedom to be equal to the number of data points minus the number of constraints. In this case, we have <span class="math notranslate nohighlight">\(N\)</span> observations (<span class="math notranslate nohighlight">\(N_1\)</span> in sample 1, and <span class="math notranslate nohighlight">\(N_2\)</span> in sample 2), and 2 constraints (the sample means). So the total degrees of freedom for this test are <span class="math notranslate nohighlight">\(N-2\)</span>.</p>
</section>
<section id="id10">
<h3><span class="section-number">14.3.6. </span>Doing the test in Python<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h3>
<p>Now, you can run an independent samples <span class="math notranslate nohighlight">\(t\)</span>-test with a method from <code class="docutils literal notranslate"><span class="pre">scipy</span></code>, and since the method for a one-sample <span class="math notranslate nohighlight">\(t\)</span>-test was <code class="docutils literal notranslate"><span class="pre">ttest_1samp</span></code>, it may come as no big surprise to you that the method for an independent-samples <span class="math notranslate nohighlight">\(t\)</span>-test is called <code class="docutils literal notranslate"><span class="pre">ttest_ind</span></code>. But from here on out, I think it will be easier for everyone (certainly easier for me!) if we use <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> to ease the process of running these tests. How will it make it easier, you ask? Well, for one thing, remember how we just used the <code class="docutils literal notranslate"><span class="pre">ttest()</span></code> function from <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> to run a one-sample <span class="math notranslate nohighlight">\(t\)</span>-test? Well we can use <em>the exact same function</em> to run <em>all</em> of the <span class="math notranslate nohighlight">\(t\)</span>-tests in this chapter. How’s that for making things easier? Also, <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> unifies the output format, so we get the same familiar table for each one of the tests.</p>
<p>So let’s give it a try. An important point here, and one that can cause a lot of frustration if you don’t realize what is going on, is that <code class="docutils literal notranslate"><span class="pre">ttest()</span></code> wants the data from the two groups served up as two separate variables (this is true of the <code class="docutils literal notranslate"><span class="pre">scipy</span></code> version as well, by the way). Since Dr Harpo sent the data to us in <em>long format</em>, that is, with all the grades in one column, and a second column telling us who the tutor was for each student, we will need to do something to break the grade data into two. So step one will be creating a new dataframe, with one column per tutor (“wide” format):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Harpo_wide</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
                <span class="p">{</span><span class="s1">&#39;Anastasia&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Anastasia&#39;</span><span class="p">][</span><span class="s1">&#39;grade&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;Bernadette&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bernadette&#39;</span><span class="p">][</span><span class="s1">&#39;grade&#39;</span><span class="p">]})</span>

<span class="n">Harpo_wide</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Anastasia</th>
      <th>Bernadette</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>65.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>72.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>74.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>73.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now, you will have noticed right away that this new dataframe has a bunch of things that aren’t numbers in it. In fact, “NaN” stands for “Not a Number”. But after a moment’s reflection, this makes perfect sense: the students were divided up between Anastasia and Bernadette, and so of course now that we have a row for each student, if a student has Anastasia as a tutor, they can’t <em>also</em> have Bernadette as a tutor. Luckily, <code class="docutils literal notranslate"><span class="pre">ttest()</span></code> is smart enough to see what is going on, and deal with it appropriately. So, now that we have all of our ducks in order, let’s do the test:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pingouin</span> <span class="kn">import</span> <span class="n">ttest</span>

<span class="n">ttest</span><span class="p">(</span><span class="n">Harpo_wide</span><span class="p">[</span><span class="s1">&#39;Anastasia&#39;</span><span class="p">],</span> <span class="n">Harpo_wide</span><span class="p">[</span><span class="s1">&#39;Bernadette&#39;</span><span class="p">],</span> <span class="n">correction</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>2.115432</td>
      <td>31</td>
      <td>two-sided</td>
      <td>0.042529</td>
      <td>[0.2, 10.76]</td>
      <td>0.739561</td>
      <td>1.755</td>
      <td>0.53577</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You probably noticed that in addition to telling <code class="docutils literal notranslate"><span class="pre">ttest()</span></code> which means I wanted to compare, I also added the argument <code class="docutils literal notranslate"><span class="pre">correction</span> <span class="pre">=</span> <span class="pre">False</span></code> to the command. This wasn’t strictly necessary in this case, because by default this argument is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. By saying <code class="docutils literal notranslate"><span class="pre">correction</span> <span class="pre">=</span> <span class="pre">False</span></code>, what we’re really doing is telling Python to use the <em>Student</em> independent samples <span class="math notranslate nohighlight">\(t\)</span>-test, and not the <em>Welch</em> independent samples <span class="math notranslate nohighlight">\(t\)</span>-test. More on this later, when we get to <a class="reference internal" href="#welchttest"><span class="std std-ref">Welch</span></a>. For now, let’s just get the descriptive statistics for Anastasia and Bernadette’s students so we can report our results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Harpo_wide</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Anastasia</th>
      <th>Bernadette</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>15.000000</td>
      <td>18.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>74.533333</td>
      <td>69.055556</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8.998942</td>
      <td>5.774918</td>
    </tr>
    <tr>
      <th>min</th>
      <td>55.000000</td>
      <td>56.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>69.000000</td>
      <td>66.250000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>76.000000</td>
      <td>69.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>79.000000</td>
      <td>73.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>90.000000</td>
      <td>79.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The difference between the two groups is significant (just barely), so we might write up the result using text like this:</p>
<blockquote>
<div><p>The mean grade in Anastasia’s class was 74.5% (std dev = 9.0), whereas the mean in Bernadette’s class was 69.1% (std dev = 5.8). A Student’s independent samples <span class="math notranslate nohighlight">\(t\)</span>-test showed that this 5.4% difference was significant (<span class="math notranslate nohighlight">\(t(31) = 2.1\)</span>, <span class="math notranslate nohighlight">\(p&lt;.05\)</span>), suggesting that a genuine difference in learning outcomes has occurred.</p>
</div></blockquote>
</section>
<section id="positive-and-negative-t-values">
<h3><span class="section-number">14.3.7. </span>Positive and negative <span class="math notranslate nohighlight">\(t\)</span> values<a class="headerlink" href="#positive-and-negative-t-values" title="Permalink to this heading">#</a></h3>
<p>Before moving on to talk about the assumptions of the <span class="math notranslate nohighlight">\(t\)</span>-test, there’s one additional point I want to make about the use of <span class="math notranslate nohighlight">\(t\)</span>-tests in practice. The first one relates to the sign of the <span class="math notranslate nohighlight">\(t\)</span>-statistic (that is, whether it is a positive number or a negative one).  One very common worry that students have when they start running their first <span class="math notranslate nohighlight">\(t\)</span>-test is that they often end up with negative values for the <span class="math notranslate nohighlight">\(t\)</span>-statistic, and don’t know how to interpret it. In fact, it’s not at all uncommon for two  people working independently to end up with Python outputs that are almost identical, except that one person has a negative <span class="math notranslate nohighlight">\(t\)</span> values and the other one has a positive <span class="math notranslate nohighlight">\(t\)</span> value. Assuming that  you’re running a two-sided test, then the <span class="math notranslate nohighlight">\(p\)</span>-values will be identical. On closer inspection, the students will notice that the confidence intervals also have the opposite signs. This is perfectly okay: whenever this happens, what you’ll find is that the two versions of the Python output arise from slightly different ways of running the <span class="math notranslate nohighlight">\(t\)</span>-test. What’s happening here is very simple. The <span class="math notranslate nohighlight">\(t\)</span>-statistic that Python is calculating here is always of the form</p>
<div class="math notranslate nohighlight">
\[
t = \frac{\mbox{(mean 1)} -\mbox{(mean 2)}}{ \mbox{(SE)}}
\]</div>
<p>If “mean 1” is larger than “mean 2” the <span class="math notranslate nohighlight">\(t\)</span> statistic will be positive, whereas if “mean 2” is larger then the <span class="math notranslate nohighlight">\(t\)</span> statistic will be negative. Similarly, the confidence interval that R reports is the confidence interval for the difference “(mean 1) minus (mean 2)”, which will be the reverse of what you’d get if you were calculating the confidence interval for the difference “(mean 2) minus (mean 1)”.</p>
<p>Okay, that’s pretty straightforward when you think about it, but now consider our <span class="math notranslate nohighlight">\(t\)</span>-test comparing Anastasia’s class to Bernadette’s class. Which one should we call “mean 1” and which one should we call “mean 2”. It’s arbitrary. However, you really do need to designate one of them as “mean 1” and the other one as “mean 2”. Not surprisingly, the way that Python handles this is also pretty arbitrary. In earlier versions of the book I used to try to explain it, but after a while I gave up, because it’s not really all that important, and to be honest I can never remember myself. Whenever I get a significant <span class="math notranslate nohighlight">\(t\)</span>-test result, and I want to figure out which mean is the larger one, I don’t try to figure it out by looking at the <span class="math notranslate nohighlight">\(t\)</span>-statistic. Why would I bother doing that? It’s foolish. It’s easier just look at the actual group means!</p>
<p>Here’s the important thing. Because it really doesn’t matter what Python printed out, I usually try to <em>report</em> the <span class="math notranslate nohighlight">\(t\)</span>-statistic in such a way that the numbers match up with the text. Here’s what I mean… suppose that what I want to write in my report is “Anastasia’s class had higher  grades than Bernadette’s class”. The phrasing here implies that Anastasia’s group comes first, so it makes sense to report the <span class="math notranslate nohighlight">\(t\)</span>-statistic as if Anastasia’s class corresponded to group 1. If so, I would write</p>
<blockquote>
<div><p>Anastasia’s class had <em>higher</em> grades than Bernadette’s class (<span class="math notranslate nohighlight">\(t(31)= 2.1, p=.04\)</span>).</p>
</div></blockquote>
<p>(I wouldn’t actually emphasise the word “higher” in real life, I’m just doing it to emphasise the point that “higher” corresponds to positive <span class="math notranslate nohighlight">\(t\)</span> values). On the other hand, suppose the phrasing I wanted to use has Bernadette’s class listed first. If so, it makes more sense to treat her class as group 1, and if so, the write up looks like this:</p>
<blockquote>
<div><p>Bernadette’s class had <em>lower</em> grades than Anastasia’s class (<span class="math notranslate nohighlight">\(t(31)= -2.1, p=.04\)</span>).</p>
</div></blockquote>
<p>Because I’m talking about one group having “lower” scores this time around, it is more sensible to use the negative form of the <span class="math notranslate nohighlight">\(t\)</span>-statistic. It just makes it read more cleanly.</p>
<p>One last thing: please note that you <em>can’t</em> do this for other types of test statistics. It works for <span class="math notranslate nohighlight">\(t\)</span>-tests, but it wouldn’t be meaningful for  chi-square testsm <span class="math notranslate nohighlight">\(F\)</span>-tests or indeed for most of the tests I talk about in this book. So don’t overgeneralise this advice! I’m really just talking about <span class="math notranslate nohighlight">\(t\)</span>-tests here and nothing else!</p>
</section>
<section id="assumptions-of-the-test">
<span id="studentassumptions"></span><h3><span class="section-number">14.3.8. </span>Assumptions of the test<a class="headerlink" href="#assumptions-of-the-test" title="Permalink to this heading">#</a></h3>
<p>As always, our hypothesis test relies on some assumptions. So what are they? For the Student t-test there are three assumptions, some of which we saw previously in the context of the one sample <span class="math notranslate nohighlight">\(t\)</span>-test (see Section &#64;ref(ttestoneassumptions)):</p>
<ul class="simple">
<li><p><em>Normality</em>. Like the one-sample <span class="math notranslate nohighlight">\(t\)</span>-test, it is assumed that the data are normally distributed. Specifically, we assume that both groups are normally distributed. In Section &#64;ref(shapiro) we’ll discuss how to test for normality, and in Section &#64;ref(wilcox) we’ll discuss possible solutions.</p></li>
<li><p><em>Independence</em>. Once again, it is assumed that the observations are independently sampled. In the context of the Student test this has two aspects to it. Firstly, we assume that the observations within each sample are independent of one another (exactly the same as for the one-sample test). However, we also assume that there are no cross-sample dependencies. If, for instance, it turns out that you included some participants in both experimental conditions of your study (e.g., by accidentally allowing the same person to sign up to different conditions), then there are some cross sample dependencies that you’d need to take into account.</p></li>
<li><p><em>Homogeneity of variance</em> (also called “homoscedasticity”). The third assumption is that the population standard deviation is the same in both groups. You can test this assumption using the Levene test, which I’ll talk about later on in the book (Section &#64;ref(levene)). However, there’s a very simple remedy for this assumption, which I’ll talk about in the next section.</p></li>
</ul>
</section>
</section>
<section id="the-independent-samples-t-test-welch-test">
<span id="welchttest"></span><h2><span class="section-number">14.4. </span>The independent samples <span class="math notranslate nohighlight">\(t\)</span>-test (Welch test)<a class="headerlink" href="#the-independent-samples-t-test-welch-test" title="Permalink to this heading">#</a></h2>
<p>The biggest problem with using the Student test in practice is the third assumption listed in the previous section: it assumes that both groups have the same standard deviation. This is rarely true in real life: if two samples don’t have the same means, why should we expect them to have the same standard deviation? There’s really no reason to expect this assumption to be true. We’ll talk a little bit about how you can check this assumption later on because it does crop up in a few different places, not just the <span class="math notranslate nohighlight">\(t\)</span>-test. But right now I’ll talk about a different form of the <span class="math notranslate nohighlight">\(t\)</span>-test <span id="id11">[<a class="reference internal" href="bibliography.html#id81" title="B. L. Welch. The generalization of “Student's” problem when several different population variances are involved. Biometrika, 34:28–35, 1947.">Welch, 1947</a>]</span> that does not rely on this assumption. A graphical illustration of what the <strong><em>Welch <span class="math notranslate nohighlight">\(t\)</span> test</em></strong> assumes about the data is shown in Figure <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-ttesthyp2</span></code>, to provide a contrast with the Student test version in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-ttesthyp</span></code>. I’ll admit it’s a bit odd to talk about the cure before talking about the diagnosis, but as it happens the Welch test is often the default <span class="math notranslate nohighlight">\(t\)</span>-test, so this is probably the best place to discuss it.</p>
<p>The Welch test is very similar to the Student test. For example, the <span class="math notranslate nohighlight">\(t\)</span>-statistic that we use in the Welch test is calculated in much the same way as it is for the Student test. That is, we take the difference between the sample means, and then divide it by some estimate of the standard error of that difference:</p>
<div class="math notranslate nohighlight">
\[
t = \frac{\bar{X}_1 - \bar{X}_2}{\mbox{SE}({\bar{X}_1 - \bar{X}_2})}
\]</div>
<p>The main difference is that the standard error calculations are different. If the two populations have different standard deviations, then it’s a complete nonsense to try to calculate a pooled standard deviation estimate, because you’re averaging apples and oranges.<a class="footnote-reference brackets" href="#note9" id="id12" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a> But you can still estimate the standard error of the difference between sample means; it just ends up looking different:</p>
<div class="math notranslate nohighlight">
\[
\mbox{SE}({\bar{X}_1 - \bar{X}_2}) = \sqrt{ \frac{{\hat{\sigma}_1}^2}{N_1} + \frac{{\hat{\sigma}_2}^2}{N_2} }
\]</div>
<p>The reason why it’s calculated this way is beyond the scope of this book. What matters for our purposes is that the <span class="math notranslate nohighlight">\(t\)</span>-statistic that comes out of the Welch test is actually somewhat different to the one that comes from the Student test.</p>
<p>The second difference between Welch and Student is that the degrees of freedom are calculated in a very different way. In the Welch test, the “degrees of freedom ” doesn’t have to be a whole number any more, and it doesn’t correspond all that closely to the “number of data points minus the number of constraints” heuristic that I’ve been using up to this point. The degrees of freedom are, in fact…</p>
<div class="math notranslate nohighlight">
\[
\mbox{df} = \frac{ ({\hat{\sigma}_1}^2 / N_1 + {\hat{\sigma}_2}^2 / N_2)^2 }{  ({\hat{\sigma}_1}^2 / N_1)^2 / (N_1 -1 )  + ({\hat{\sigma}_2}^2 / N_2)^2 / (N_2 -1 ) } 
\]</div>
<p>… which is all pretty straightforward and obvious, right? Well, perhaps not. It doesn’t really matter for our purposes. What matters is that you’ll see that the “df” value that pops out of a Welch test tends to be a little bit smaller than the one used for the Student test, and it doesn’t have to be a whole number.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu1</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="mf">1.45</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu1</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">sigma1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y1</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">mu1</span><span class="p">,</span> <span class="n">sigma1</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">mu2</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">sigma</span><span class="p">,</span> <span class="n">mu2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">sigma2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">mu2</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>


<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x2</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax2</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="s1">&#39;null hypothesis&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="s1">&#39;alternative hypothesis&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mu$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mu_1$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.50</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\mu_2$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_frame_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x162389810&gt;
</pre></div>
</div>
<img alt="_images/3cdf83322ae9d1f6d36814769b33bd2ee3f53872c3f3513f2bca2950b2115fad.png" src="_images/3cdf83322ae9d1f6d36814769b33bd2ee3f53872c3f3513f2bca2950b2115fad.png" />
</div>
</div>
<section id="id13">
<h3><span class="section-number">14.4.1. </span>Doing the test in Python<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h3>
<p>To run a Welch test in Python is pretty easy. All you have to do is not bother telling Python to assume equal variances. That is, the command is exactly the same as for the Student test, but where <code class="docutils literal notranslate"><span class="pre">correction</span> <span class="pre">=</span> <span class="pre">True</span></code>. In fact, in this case, you could just leave the <code class="docutils literal notranslate"><span class="pre">correction</span></code> argument off entirely, because Anasatasia and Bernadette had different numbers of students, and in cases where the <span class="math notranslate nohighlight">\(t\)</span>-test is comparing two unequal-sized samples, <code class="docutils literal notranslate"><span class="pre">pingouin</span></code> assumes unequal variance and does a Welch test by default, which is why we had to force it to do a Student test above by setting <code class="docutils literal notranslate"><span class="pre">correction</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pingouin</span> <span class="kn">import</span> <span class="n">ttest</span>

<span class="n">ttest</span><span class="p">(</span><span class="n">Harpo_wide</span><span class="p">[</span><span class="s1">&#39;Anastasia&#39;</span><span class="p">],</span> <span class="n">Harpo_wide</span><span class="p">[</span><span class="s1">&#39;Bernadette&#39;</span><span class="p">],</span> <span class="n">correction</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>2.034187</td>
      <td>23.024806</td>
      <td>two-sided</td>
      <td>0.05361</td>
      <td>[-0.09, 11.05]</td>
      <td>0.739561</td>
      <td>1.556</td>
      <td>0.53577</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Not too difficult, right? Not surprisingly, the output has exactly the same format as it did last time too: a test statistic <span class="math notranslate nohighlight">\(t\)</span>, and a <span class="math notranslate nohighlight">\(p\)</span>-value. So that’s all pretty easy.</p>
<p>Except, except… our result isn’t significant anymore. When we ran the Student test, we did get a significant effect; but the Welch test on the same data set is not (<span class="math notranslate nohighlight">\(t(23.03) = 2.03\)</span>, <span class="math notranslate nohighlight">\(p = .054\)</span>). What does this mean? Should we panic? Is the sky burning? Probably not. The fact that one test is significant and the other isn’t doesn’t itself mean very much, especially since I kind of rigged the data so that this would happen. As a general rule, it’s not a good idea to go out of your way to try to interpret or explain the difference between a <span class="math notranslate nohighlight">\(p\)</span>-value of .049 and a <span class="math notranslate nohighlight">\(p\)</span>-value of .051. If this sort of thing happens in real life, the <em>difference</em> in these <span class="math notranslate nohighlight">\(p\)</span>-values is almost certainly due to chance. What does matter is that you take a little bit of care in thinking about what test you use. The Student test and the Welch test have different strengths and weaknesses. If the two populations really do have equal variances, then the Student test is slightly more powerful (lower Type II error rate) than the Welch test. However, if they <em>don’t</em> have the same variances, then the assumptions of the Student test are violated and you may not be able to trust it: you might end up with a higher Type I error rate. So it’s a trade off. However, in real life, I tend to prefer the Welch test; because almost no-one <em>actually</em> believes that the population variances are identical.</p>
</section>
<section id="id14">
<h3><span class="section-number">14.4.2. </span>Assumptions of the test<a class="headerlink" href="#id14" title="Permalink to this heading">#</a></h3>
<p>The assumptions of the Welch test are very similar to those made by the <a class="reference internal" href="#studentassumptions"><span class="std std-ref">Student <span class="math notranslate nohighlight">\(t\)</span>-test</span></a>, except that the Welch test does not assume homogeneity of variance. This leaves only the assumption of normality, and the assumption of independence. The specifics of these assumptions are the same for the Welch test as for the Student test.</p>
</section>
</section>
<section id="the-paired-samples-t-test">
<span id="pairedsamplesttest"></span><h2><span class="section-number">14.5. </span>The paired-samples <span class="math notranslate nohighlight">\(t\)</span>-test<a class="headerlink" href="#the-paired-samples-t-test" title="Permalink to this heading">#</a></h2>
<p>Regardless of whether we’re talking about the Student test or the Welch test, an independent samples <span class="math notranslate nohighlight">\(t\)</span>-test is intended to be used in a situation where you have two samples that are, well, independent of one another. This situation arises naturally when participants are assigned randomly to one of two experimental conditions, but it provides a very poor approximation to other sorts of research designs. In particular, a repeated measures design – in which each participant is measured (with respect to the same outcome variable) in both experimental conditions – is not suited for analysis using independent samples <span class="math notranslate nohighlight">\(t\)</span>-tests. For example, we might be interested in whether listening to music reduces people’s working memory capacity. To that end, we could measure each person’s working memory capacity in two conditions: with music, and without music. In an experimental design such as this one,<a class="footnote-reference brackets" href="#note10" id="id15" role="doc-noteref"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></a> each participant appears in <em>both</em> groups. This requires us to approach the problem in a different way; by using the <strong><em>paired samples <span class="math notranslate nohighlight">\(t\)</span>-test</em></strong>.</p>
<section id="id16">
<h3><span class="section-number">14.5.1. </span>The data<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h3>
<p>The data set that we’ll use this time comes from Dr Chico’s class.<a class="footnote-reference brackets" href="#note11" id="id17" role="doc-noteref"><span class="fn-bracket">[</span>12<span class="fn-bracket">]</span></a> In her class, students take two major tests, one early in the semester and one later in the semester. To hear her tell it, she runs a very hard class, one that most students find very challenging; but she argues that by setting hard assessments, students are encouraged to work harder. Her theory is that the first test is a bit of a “wake up call” for students: when they realise how hard her class really is, they’ll work harder for the second test and get a better mark. Is she right? To test this, let’s have a look at the <code class="docutils literal notranslate"><span class="pre">chico.csv</span></code> file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/chico.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The data frame <code class="docutils literal notranslate"><span class="pre">chico</span></code> contains three variables: an <code class="docutils literal notranslate"><span class="pre">id</span></code> variable that identifies each student in the class, the <code class="docutils literal notranslate"><span class="pre">grade_test1</span></code> variable that records the student grade for the first test, and the <code class="docutils literal notranslate"><span class="pre">grade_test2</span></code> variable that has the grades for the second test. Here’s the first five students:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>grade_test1</th>
      <th>grade_test2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>student1</td>
      <td>42.9</td>
      <td>44.6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>student2</td>
      <td>51.8</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>student3</td>
      <td>71.7</td>
      <td>72.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>student4</td>
      <td>51.6</td>
      <td>53.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>student5</td>
      <td>63.5</td>
      <td>63.8</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>At a glance, it does seem like the class is a hard one (most grades are between 50% and 60%), but it does look like there’s an improvement from the first test to the second one. If we take a quick look at the descriptive statistics</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>grade_test1</th>
      <th>grade_test2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>20.000000</td>
      <td>20.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>56.980000</td>
      <td>58.385000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.616137</td>
      <td>6.405612</td>
    </tr>
    <tr>
      <th>min</th>
      <td>42.900000</td>
      <td>44.600000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>51.750000</td>
      <td>53.100000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>57.700000</td>
      <td>59.700000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>62.050000</td>
      <td>63.050000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>71.700000</td>
      <td>72.300000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>we see that this impression seems to be supported. Across all 20 students<a class="footnote-reference brackets" href="#note12" id="id18" role="doc-noteref"><span class="fn-bracket">[</span>13<span class="fn-bracket">]</span></a> the mean grade for the first test is 57%, but this rises to 58% for the second test. Although, given that the standard deviations are 6.6% and 6.4% respectively, it’s starting to feel like maybe the improvement is just illusory; maybe just random variation. This impression is reinforced when you see the means and confidence intervals plotted in <code class="xref std std-numref docutils literal notranslate"><span class="pre">pairedta</span></code> panel A. If we were to rely on this plot alone, we’d come to the same conclusion that we got from looking at the descriptive statistics that the <code class="docutils literal notranslate"><span class="pre">describe()</span></code> method produced. Looking at how wide those confidence intervals are, we’d be tempted to think that the apparent improvement in student performance is pure chance.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/chico.csv&quot;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;grade_test1&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;grade_test2&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ax2</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">(),</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;.3&quot;</span><span class="p">)</span>

<span class="c1">#ax1.set_ylim(40,80)</span>
<span class="c1">#ax1.set_xlim(40,80)</span>
<span class="c1">#ax1.set_ylim(40,80)</span>


<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;improvement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;grade_test2&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;grade_test1&#39;</span><span class="p">]</span>

<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">df2</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;improvement&#39;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>


<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/ca0e2f1443ed8c2894c69f70ef8bdf80839a07c4077764da3a52298fea3e6f6b.png" src="_images/ca0e2f1443ed8c2894c69f70ef8bdf80839a07c4077764da3a52298fea3e6f6b.png" />
</div>
</div>
<p>Nevertheless, this impression is wrong. To see why, take a look at the scatterplot of the grades for test 1 against the grades for test 2.  shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-pairedta</span></code> panel B.</p>
<p>In this plot, each dot corresponds to the two grades for a given student: if their grade for test 1 (<span class="math notranslate nohighlight">\(x\)</span> co-ordinate) equals their grade for test 2 (<span class="math notranslate nohighlight">\(y\)</span> co-ordinate), then the dot falls on the line. Points falling above the line are the students that performed better on the second test. Critically, almost all of the data points fall above the diagonal line: almost all of the students <em>do</em> seem to have improved their grade, if only by a small amount. This suggests that we should be looking at the <em>improvement</em> made by each student from one test to the next, and treating that as our raw data. To do this, we’ll need to create a new variable for the <code class="docutils literal notranslate"><span class="pre">improvement</span></code> that each student makes, and add it to the data frame containing the <code class="docutils literal notranslate"><span class="pre">chico.csv</span></code> data. The easiest way to do this is as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;improvement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test2&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test1&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that I assigned the output to a variable called <code class="docutils literal notranslate"><span class="pre">df['improvement]</span></code>. That has the effect of creating a new column called <code class="docutils literal notranslate"><span class="pre">improvement</span></code> inside the <code class="docutils literal notranslate"><span class="pre">chico</span></code> data frame. Now that we’ve created and stored this <code class="docutils literal notranslate"><span class="pre">improvement</span></code> variable, we can draw a histogram showing the distribution of these improvement scores, shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig-pairedta</span></code> panel C.</p>
<p>When we look at histogram, it’s very clear that there <em>is</em> a real improvement here. The vast majority of the students scored higher on the test 2 than on test 1, reflected in the fact that almost the entire histogram is above zero. In fact, if we use <code class="docutils literal notranslate"><span class="pre">scipy.stats.t.interval()</span></code> to compute a confidence interval for the population mean of this new variable,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;improvement&#39;</span><span class="p">]</span>

<span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">stats</span><span class="o">.</span><span class="n">sem</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.9508686092602991, 1.8591313907397005)
</pre></div>
</div>
</div>
</div>
<p>we see that it is 95% certain that the true (population-wide) average improvement would lie between 0.95% and 1.86%. So you can see, qualitatively, what’s going on: there is a real “within student” improvement (everyone improves by about 1%), but it is very small when set against the quite large “between student” differences (student grades vary by about 20% or so).</p>
</section>
<section id="what-is-the-paired-samples-t-test">
<h3><span class="section-number">14.5.2. </span>What is the paired samples <span class="math notranslate nohighlight">\(t\)</span>-test?<a class="headerlink" href="#what-is-the-paired-samples-t-test" title="Permalink to this heading">#</a></h3>
<p>In light of the previous exploration, let’s think about how to construct an appropriate <span class="math notranslate nohighlight">\(t\)</span> test. One possibility would be to try to run an independent samples <span class="math notranslate nohighlight">\(t\)</span>-test using <code class="docutils literal notranslate"><span class="pre">grade_test1</span></code> and <code class="docutils literal notranslate"><span class="pre">grade_test2</span></code> as the variables of interest. However, this is clearly the wrong thing to do: the independent samples <span class="math notranslate nohighlight">\(t\)</span>-test assumes that there is no particular relationship between the two samples. Yet clearly that’s not true in this case, because of the repeated measures structure to the data. To use the language that I introduced in the last section, if we were to try to do an independent samples <span class="math notranslate nohighlight">\(t\)</span>-test, we would be conflating the <strong><em>within subject</em></strong> differences (which is what we’re interested in testing) with the <strong><em>between subject</em></strong> variability (which we are not).</p>
<p>The solution to the problem is obvious, I hope, since we already did all the hard work in the previous section. Instead of running an independent samples <span class="math notranslate nohighlight">\(t\)</span>-test on <code class="docutils literal notranslate"><span class="pre">grade_test1</span></code> and <code class="docutils literal notranslate"><span class="pre">grade_test2</span></code>, we run a <em>one-sample</em> <span class="math notranslate nohighlight">\(t\)</span>-test on the within-subject difference variable, <code class="docutils literal notranslate"><span class="pre">improvement</span></code>. To formalise this slightly, if <span class="math notranslate nohighlight">\(X_{i1}\)</span> is the score that the <span class="math notranslate nohighlight">\(i\)</span>-th participant obtained on the first variable, and <span class="math notranslate nohighlight">\(X_{i2}\)</span> is the score that the same person obtained on the second one, then the difference score is:</p>
<div class="math notranslate nohighlight">
\[
D_{i} = X_{i1} - X_{i2} 
\]</div>
<p>Notice that the difference scores is <em>variable 1 minus variable 2</em> and not the other way around, so if we want improvement to correspond to a positive valued difference, we actually want “test 2” to be our “variable 1”. Equally, we would say that <span class="math notranslate nohighlight">\(\mu_D = \mu_1 - \mu_2\)</span> is the population mean for this difference variable. So, to convert this to a hypothesis test, our null hypothesis is that this mean difference is zero; the alternative hypothesis is that it is not:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ll}
H_0: &amp; \mu_D = 0  \\
H_1: &amp; \mu_D \neq 0
\end{array}
\end{split}\]</div>
<p>(this is assuming we’re talking about a two-sided test here). This is more or less identical to the way we described the hypotheses for the one-sample <span class="math notranslate nohighlight">\(t\)</span>-test: the only difference is that the specific value that the null hypothesis predicts is 0. And so our <span class="math notranslate nohighlight">\(t\)</span>-statistic is defined in more or less the same way too. If we let <span class="math notranslate nohighlight">\(\bar{D}\)</span> denote the mean of the difference scores, then</p>
<div class="math notranslate nohighlight">
\[
t = \frac{\bar{D}}{\mbox{SE}({\bar{D}})}
\]</div>
<p>which is</p>
<div class="math notranslate nohighlight">
\[
t = \frac{\bar{D}}{\hat\sigma_D / \sqrt{N}}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat\sigma_D\)</span> is the standard deviation of the difference scores. Since this is just an ordinary, one-sample <span class="math notranslate nohighlight">\(t\)</span>-test, with nothing special about it, the degrees of freedom are still <span class="math notranslate nohighlight">\(N-1\)</span>. And that’s it: the paired samples <span class="math notranslate nohighlight">\(t\)</span>-test really isn’t a new test at all: it’s a one-sample <span class="math notranslate nohighlight">\(t\)</span>-test, but applied to the difference between two variables. It’s actually very simple; the only reason it merits a discussion as long as the one we’ve just gone through is that you need to be able to recognise <em>when</em> a paired samples test is appropriate, and to understand <em>why</em> it’s better than an independent samples <span class="math notranslate nohighlight">\(t\)</span> test.</p>
</section>
<section id="id19">
<h3><span class="section-number">14.5.3. </span>Doing the test in Python<a class="headerlink" href="#id19" title="Permalink to this heading">#</a></h3>
<p>How do you do a paired samples <span class="math notranslate nohighlight">\(t\)</span>-test in Python? One possibility is to follow the process I outlined above: create a “difference” variable and then run a one sample <span class="math notranslate nohighlight">\(t\)</span>-test on that, setting the population mean argument <code class="docutils literal notranslate"><span class="pre">popmean</span></code> to zero. Since we’ve already created a variable called <code class="docutils literal notranslate"><span class="pre">improvement</span></code>, let’s do that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pingouin</span> <span class="kn">import</span> <span class="n">ttest</span>
<span class="n">ttest</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;improvement&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>6.475436</td>
      <td>19</td>
      <td>two-sided</td>
      <td>0.000003</td>
      <td>[0.95, 1.86]</td>
      <td>1.447952</td>
      <td>5991.577</td>
      <td>0.999984</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>However, suppose you’re lazy and you don’t want to go to all the effort of creating a new variable. Or perhaps you just want to keep the difference between one-sample and paired-samples tests clear in your head. In that case, you can do:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pingouin</span> <span class="kn">import</span> <span class="n">ttest</span>

<span class="n">ttest</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test2&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test1&#39;</span><span class="p">],</span> <span class="n">paired</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>6.475436</td>
      <td>19</td>
      <td>two-sided</td>
      <td>0.000003</td>
      <td>[0.95, 1.86]</td>
      <td>0.215765</td>
      <td>5991.577</td>
      <td>0.150446</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Either way, you’ll get the same <span class="math notranslate nohighlight">\(t\)</span>-value, and the same <span class="math notranslate nohighlight">\(p\)</span>-value, which is strangely comforting, actually.  Not only that, but the result confirms our intuition. There’s an average improvement of 1.4% from test 1 to test 2, and this is significantly different from 0 (<span class="math notranslate nohighlight">\(t\)</span>(19) = 6.48, <span class="math notranslate nohighlight">\(p\)</span> &lt; .001). In fact, <span class="math notranslate nohighlight">\(p\)</span> is quite a bit less than one, since the <span class="math notranslate nohighlight">\(p\)</span>-value has been given in scientific notation. The exact <span class="math notranslate nohighlight">\(p\)</span>-value is <span class="math notranslate nohighlight">\(3.32^{-06}\)</span>, that is, <span class="math notranslate nohighlight">\(p\)</span> = 0.0000032.</p>
</section>
</section>
<section id="one-sided-tests">
<h2><span class="section-number">14.6. </span>One sided tests<a class="headerlink" href="#one-sided-tests" title="Permalink to this heading">#</a></h2>
<p>When introducing the theory of null hypothesis tests, I mentioned that there are some situations <a class="reference internal" href="04.04-hypothesis-testing.html#one-two-sided"><span class="std std-ref">when it’s appropriate to specify a <em>one-sided</em> test</span></a>. So far, all of the <span class="math notranslate nohighlight">\(t\)</span>-tests have been two-sided tests. For instance, when we specified a one sample <span class="math notranslate nohighlight">\(t\)</span>-test for the grades in Dr Zeppo’s class, the null hypothesis was that the true mean was 67.5%. The alternative hypothesis was that the true mean was greater than <em>or</em> less than 67.5%. Suppose we were only interested in finding out if the true mean is greater than 67.5%, and have no interest whatsoever in testing to find out if the true mean is lower than 67.5%. If so, our null hypothesis would be that the true mean is 67.5% or less, and the alternative hypothesis would be that the true mean is greater than 67.5%. The <code class="docutils literal notranslate"><span class="pre">ttest()</span></code> function lets you do this, by specifying the <code class="docutils literal notranslate"><span class="pre">alternative</span></code> argument. If you set <code class="docutils literal notranslate"><span class="pre">alternative</span> <span class="pre">=</span> <span class="pre">'greater'</span></code>, it means that you’re testing to see if the true mean is larger than <code class="docutils literal notranslate"><span class="pre">mu</span></code>. If you set <code class="docutils literal notranslate"><span class="pre">alternative</span> <span class="pre">=</span> <span class="pre">'less'</span></code>, then you’re testing to see if the true mean is smaller than <code class="docutils literal notranslate"><span class="pre">mu</span></code>. To see how it would work for Dr Zeppo’s class, let’s compare the results of the two-sided test we did before with the results of a one-sided test, where the alternative hypothesis is set to “greater”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pingouin</span> <span class="kn">import</span> <span class="n">ttest</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/zeppo.csv&quot;</span><span class="p">)</span>

<span class="c1"># two-sided test</span>
<span class="n">ttest</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grades&#39;</span><span class="p">],</span> <span class="mf">67.5</span><span class="p">,</span> <span class="n">alternative</span> <span class="o">=</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>2.254713</td>
      <td>19</td>
      <td>two-sided</td>
      <td>0.036145</td>
      <td>[67.84, 76.76]</td>
      <td>0.504169</td>
      <td>1.795</td>
      <td>0.571446</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># one-sided test</span>
<span class="n">ttest</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grades&#39;</span><span class="p">],</span> <span class="mf">67.5</span><span class="p">,</span> <span class="n">alternative</span> <span class="o">=</span> <span class="s1">&#39;greater&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>T</th>
      <th>dof</th>
      <th>alternative</th>
      <th>p-val</th>
      <th>CI95%</th>
      <th>cohen-d</th>
      <th>BF10</th>
      <th>power</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T-test</th>
      <td>2.254713</td>
      <td>19</td>
      <td>greater</td>
      <td>0.018073</td>
      <td>[68.62, inf]</td>
      <td>0.504169</td>
      <td>3.59</td>
      <td>0.701407</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <span class="math notranslate nohighlight">\(t\)</span>-statistics are exactly the same, which makes sense, if you think about it, because the calculation of the <span class="math notranslate nohighlight">\(t\)</span> is based on the mean and standard deviation, and these do not change. The <span class="math notranslate nohighlight">\(p\)</span>-value, on the other hand, is lower for the one-sided test. The only thing that changes between the two tests is the <em>expectation</em> that we bring to data. The way that the <span class="math notranslate nohighlight">\(p\)</span>-value is calculated depends on those expectations, and they are the reason for choosing one test over the other. It should go without saying, but maybe is worth saying anyway, that our reasons for choosing one test over the other should be theoretical, and not based on which test is more likely to give us the <span class="math notranslate nohighlight">\(p\)</span>-value we want!</p>
<p>So that’s how to do a one-sided one sample <span class="math notranslate nohighlight">\(t\)</span>-test. However, all versions of the <span class="math notranslate nohighlight">\(t\)</span>-test can be one-sided. For an independent samples <span class="math notranslate nohighlight">\(t\)</span> test, you could have a one-sided test if you’re only interestd in testing to see if group A has <em>higher</em> scores than group B, but have no interest in finding out if group B has higher scores than group A. Let’s suppose that, for Dr Harpo’s class, you wanted to see if Anastasia’s students had higher grades than Bernadette’s. The <code class="docutils literal notranslate"><span class="pre">ttest_ind</span></code> function lets you do this, again by specifying the <code class="docutils literal notranslate"><span class="pre">alternative</span></code> argument. However, this time around the order that we enter the variables in the test makes a difference. If we expect that Anastasia’s students have higher grades, and we want to conduct a one-sided test, we need to the data for Anastasia’s students <em>first</em>. Otherwise, we end up testing the hypothesis that <em>Bernadette’s</em> students had the higher grade, which is the opposite of what we intended:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/harpo.csv&quot;</span><span class="p">)</span>

<span class="c1"># create two new variables for the grades from each tutor&#39;s students</span>
<span class="n">Anastasia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Anastasia&#39;</span><span class="p">][</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>
<span class="n">Bernadette</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bernadette&#39;</span><span class="p">][</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>

<span class="c1"># run an independent samples t-test</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Two-sided:&#39;</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">Anastasia</span><span class="p">,</span> <span class="n">Bernadette</span><span class="p">,</span> <span class="n">equal_var</span> <span class="o">=</span> <span class="kc">True</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;One-sided, Anastasia first:&#39;</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">Anastasia</span><span class="p">,</span> <span class="n">Bernadette</span><span class="p">,</span> <span class="n">equal_var</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">alternative</span> <span class="o">=</span> <span class="s1">&#39;greater&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;One-sided, Bernadette first:&#39;</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">Bernadette</span><span class="p">,</span> <span class="n">Anastasia</span><span class="p">,</span> <span class="n">equal_var</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">alternative</span> <span class="o">=</span> <span class="s1">&#39;greater&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Two-sided: Ttest_indResult(statistic=array([2.11543239]), pvalue=array([0.04252949]))

One-sided, Anastasia first: Ttest_indResult(statistic=array([2.11543239]), pvalue=array([0.02126474]))

One-sided, Bernadette first: Ttest_indResult(statistic=array([-2.11543239]), pvalue=array([0.97873526]))
</pre></div>
</div>
</div>
</div>
<p>What about the paired samples <span class="math notranslate nohighlight">\(t\)</span>-test? Suppose we wanted to test the hypothesis that grades go <em>up</em> from test 1 to test 2 in Dr. Chico’s class, and are not prepared to consider the idea that the grades go down. Again, we can use the <code class="docutils literal notranslate"><span class="pre">alternative</span></code> argument to specify the one-sided test, and it works the same way it does for the independent samples <span class="math notranslate nohighlight">\(t\)</span>-test. Since we are comparing test 1 to test 2 by substracting one from the other, it makes a difference whether we subract test 1 from test 2, or test 2 from test 1. So, to test the hypothesis that grades for test 2 are higher than test 2, we will need to enter the grades from test 2 first; otherwise we are testing the opposite hypothesis:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">ttest_rel</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/chico.csv&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;test 2 - test 1:&#39;</span><span class="p">,</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test2&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test1&#39;</span><span class="p">],</span> <span class="n">alternative</span> <span class="o">=</span> <span class="s1">&#39;greater&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;test 1 - test 2:&#39;</span><span class="p">,</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test1&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test2&#39;</span><span class="p">],</span> <span class="n">alternative</span> <span class="o">=</span> <span class="s1">&#39;greater&#39;</span><span class="p">))</span>      
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>test 2 - test 1: Ttest_relResult(statistic=6.475436088339379, pvalue=1.660335028063474e-06)

test 1 - test 2: Ttest_relResult(statistic=-6.475436088339379, pvalue=0.9999983396649719)
</pre></div>
</div>
</div>
</div>
</section>
<section id="effect-size">
<span id="cohensd"></span><h2><span class="section-number">14.7. </span>Effect size<a class="headerlink" href="#effect-size" title="Permalink to this heading">#</a></h2>
<p>The most commonly used measure of effect size for a <span class="math notranslate nohighlight">\(t\)</span>-test is <strong><em>Cohen’s <span class="math notranslate nohighlight">\(d\)</span></em></strong> [&#64;Cohen1988]. It’s a very simple measure in principle, with quite a few wrinkles when you start digging into the details. Cohen himself defined it primarily in the context of an independent samples <span class="math notranslate nohighlight">\(t\)</span>-test, specifically the Student test. In that context, a natural way of defining the effect size is to divide the difference between the means by an estimate of the standard deviation. In other words, we’re looking to calculate <em>something</em> along the lines of this:</p>
<div class="math notranslate nohighlight">
\[
d = \frac{\mbox{(mean 1)} - \mbox{(mean 2)}}{\mbox{std dev}}
\]</div>
<p>and he suggested a rough guide for interpreting <span class="math notranslate nohighlight">\(d\)</span> in the table below. You’d think that this would be pretty unambiguous, but it’s not; largely because Cohen wasn’t too specific on what he thought should be used as the measure of the standard deviation (in his defence, he was trying to make a broader point in his book, not nitpick about tiny details). As discussed by &#64;McGrath2006, there are several different version in common usage, and each author tends to adopt slightly different notation. For the sake of simplicity (as opposed to accuracy) I’ll use <span class="math notranslate nohighlight">\(d\)</span> to refer to any statistic that you calculate from the sample, and  use <span class="math notranslate nohighlight">\(\delta\)</span> to refer to a theoretical population effect. Obviously, that does mean that there are several different things all called <span class="math notranslate nohighlight">\(d\)</span>.</p>
<p>Although Cohen’s <span class="math notranslate nohighlight">\(d\)</span> is a very commonly-reported measure of effect size, there are not currently any modules that provide built-in tools to calculate it. At least, not any that I am aware of. Luckily, it isn’t too hard to calculate “by hand”.</p>
<p id="dinterpretation">The table below gives a (very) rough guide to interpreting Cohen’s <span class="math notranslate nohighlight">\(d\)</span>. My personal recommendation is to not use these blindly. The <span class="math notranslate nohighlight">\(d\)</span> statistic has a natural interpretation in and of itself: it redescribes the different in means as the number of standard deviations that separates those means. So it’s generally a good idea to think about what that means in practical terms. In some contexts a “small” effect could be of big practical importance. In other situations a “large” effect may not be all that interesting.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>d-value</p></th>
<th class="head text-left"><p>rough interpretation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>about 0.2</p></td>
<td class="text-left"><p>“small” effect</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>about 0.5</p></td>
<td class="text-left"><p>“moderate” effect</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>about 0.8</p></td>
<td class="text-left"><p>“large” effect</p></td>
</tr>
</tbody>
</table>
<section id="cohen-s-d-from-one-sample">
<h3><span class="section-number">14.7.1. </span>Cohen’s <span class="math notranslate nohighlight">\(d\)</span> from one sample<a class="headerlink" href="#cohen-s-d-from-one-sample" title="Permalink to this heading">#</a></h3>
<p>The simplest situation to consider is the one corresponding to a one-sample <span class="math notranslate nohighlight">\(t\)</span>-test. In this case, the one sample mean <span class="math notranslate nohighlight">\(\bar{X}\)</span> and one (hypothesised) population mean <span class="math notranslate nohighlight">\(\mu_o\)</span> to compare it to. Not only that, there’s really only one sensible way to estimate the population standard deviation: we just use our usual estimate <span class="math notranslate nohighlight">\(\hat{\sigma}\)</span>. Therefore, we end up with the following as the only way to calculate <span class="math notranslate nohighlight">\(d\)</span>,</p>
<div class="math notranslate nohighlight">
\[
d = \frac{\bar{X} - \mu_0}{\hat{\sigma}}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statistics</span>

<span class="c1"># load Zeppo data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/zeppo.csv&quot;</span><span class="p">)</span>

<span class="c1"># subract the population mean from the sample mean, and divide by </span>
<span class="c1">#the estimated population standard deviation</span>

<span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">statistics</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grades&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mf">67.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">statistics</span><span class="o">.</span><span class="n">stdev</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grades&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cohen</span><span class="se">\&#39;</span><span class="s1">s d:&#39;</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cohen&#39;s d: 0.5041691240370938
</pre></div>
</div>
</div>
</div>
<p>What does this effect size mean? Overall, then, the psychology students in Dr Zeppo’s class are achieving grades (mean = 72.3%) that are about .5 standard deviations higher than the level that you’d expect (67.5%) if they were performing at the same level as other students. Judged against Cohen’s rough guide, this is a moderate effect size.</p>
</section>
<section id="cohen-s-d-from-a-student-t-test">
<h3><span class="section-number">14.7.2. </span>Cohen’s <span class="math notranslate nohighlight">\(d\)</span> from a Student <span class="math notranslate nohighlight">\(t\)</span> test<a class="headerlink" href="#cohen-s-d-from-a-student-t-test" title="Permalink to this heading">#</a></h3>
<p>The majority of discussions of Cohen’s <span class="math notranslate nohighlight">\(d\)</span> focus on a situation that is analogous to Student’s independent samples <span class="math notranslate nohighlight">\(t\)</span> test, and it’s in this context that the story becomes messier, since there are several different versions of <span class="math notranslate nohighlight">\(d\)</span> that you might want to use in this situation. To understand why there are multiple versions of <span class="math notranslate nohighlight">\(d\)</span>, it helps to take the time to write down a formula that corresponds to the true population effect size <span class="math notranslate nohighlight">\(\delta\)</span>. It’s pretty straightforward,</p>
<div class="math notranslate nohighlight">
\[
\delta = \frac{\mu_1 - \mu_2}{\sigma}
\]</div>
<p>where, as usual, <span class="math notranslate nohighlight">\(\mu_1\)</span> and <span class="math notranslate nohighlight">\(\mu_2\)</span> are the population means corresponding to group 1 and group 2 respectively, and <span class="math notranslate nohighlight">\(\sigma\)</span> is the standard deviation (the same for both populations). The obvious way to estimate <span class="math notranslate nohighlight">\(\delta\)</span> is to do exactly the same thing that we did in the <span class="math notranslate nohighlight">\(t\)</span>-test itself: use the sample means as the top line, and a pooled standard deviation estimate for the bottom line:</p>
<div class="math notranslate nohighlight">
\[
d = \frac{\bar{X}_1 - \bar{X}_2}{\hat{\sigma}_p}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat\sigma_p\)</span> is the exact same pooled standard deviation measure that appears in the <span class="math notranslate nohighlight">\(t\)</span>-test. This is the most commonly used version of Cohen’s <span class="math notranslate nohighlight">\(d\)</span> when applied to the outcome of a Student <span class="math notranslate nohighlight">\(t\)</span>-test ,and is sometimes referred to as Hedges’ <span class="math notranslate nohighlight">\(g\)</span> statistic [&#64;Hedges1981].</p>
<p>However, there are other possibilities, which I’ll briefly describe. Firstly, you may have reason to want to use only one of the two groups as the basis for calculating the standard deviation. This approach (often called Glass’ <span class="math notranslate nohighlight">\(\Delta\)</span>) only makes most sense when you have good reason to treat one of the two groups as a purer reflection of “natural variation” than the other. This can happen if, for instance, one of the two groups is a control group. Secondly, recall that in the usual calculation of the pooled standard deviation we divide by <span class="math notranslate nohighlight">\(N-2\)</span> to correct for the bias in the sample variance; in one version of Cohen’s <span class="math notranslate nohighlight">\(d\)</span> this correction is omitted. Instead, we divide by <span class="math notranslate nohighlight">\(N\)</span>. This version makes sense primarily when you’re trying to calculate the effect size in the sample; rather than estimating an effect size in the population. Finally, there is a version based on &#64;Hedges1985, who point out there is a small bias in the usual (pooled) estimation for Cohen’s <span class="math notranslate nohighlight">\(d\)</span>. Thus they introduce a small correction, by multiplying the usual value of <span class="math notranslate nohighlight">\(d\)</span> by <span class="math notranslate nohighlight">\((N-3)/(N-2.25)\)</span>.</p>
<p>In any case, ignoring all those variations that you could make use of if you wanted, let’s have a look at how to calculate the default version. In particular, suppose we look at the data from Dr Harpo’s class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statistics</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/harpo.csv&quot;</span><span class="p">)</span>

<span class="c1"># create two new variables for the grades from each tutor&#39;s students</span>
<span class="n">tutor1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Anastasia&#39;</span><span class="p">][</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>
<span class="n">tutor2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;tutor&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Bernadette&#39;</span><span class="p">][</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>

<span class="c1"># find number of student grades for each tutor</span>
<span class="n">n1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tutor1</span><span class="p">)</span>
<span class="n">n2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tutor2</span><span class="p">)</span>

<span class="c1"># find mean student grade for each tutor</span>
<span class="n">u1</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">tutor1</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">tutor2</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>

<span class="c1"># find variance in students&#39; grades for each tutor</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="n">tutor1</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="n">tutor2</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>


<span class="c1"># find pooled standard deviation (square root of weighted variation, </span>
<span class="c1"># divided by total N, with a correction for bias of -2)</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(((</span><span class="n">n1</span><span class="p">)</span> <span class="o">*</span> <span class="n">s1</span> <span class="o">+</span> <span class="p">(</span><span class="n">n2</span><span class="p">)</span> <span class="o">*</span> <span class="n">s2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>

<span class="c1"># calculate Cohen&#39;s d</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">u1</span> <span class="o">-</span> <span class="n">u2</span><span class="p">)</span> <span class="o">/</span> <span class="n">s</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7395614040382655
</pre></div>
</div>
</div>
</div>
</section>
<section id="cohen-s-d-from-a-welch-test">
<h3><span class="section-number">14.7.3. </span>Cohen’s <span class="math notranslate nohighlight">\(d\)</span> from a Welch test<a class="headerlink" href="#cohen-s-d-from-a-welch-test" title="Permalink to this heading">#</a></h3>
<p>Suppose the situation you’re in is more like the Welch test: you still have two independent samples, but you no longer believe that the corresponding populations have equal variances. When this happens, we have to redefine what we mean by the population effect size. I’ll refer to this new measure as <span class="math notranslate nohighlight">\(\delta^\prime\)</span>, so as to keep it distinct from the measure <span class="math notranslate nohighlight">\(\delta\)</span> which we defined previously. What &#64;Cohen1988 suggests is that we could define our new population effect size by averaging the two population variances. What this means is that we get:</p>
<div class="math notranslate nohighlight">
\[
\delta^\prime = \frac{\mu_1 - \mu_2}{\sigma^\prime}
\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[
\sigma^\prime = \sqrt{\displaystyle{\frac{ {\sigma_1}^2 + {\sigma_2}^2}{2}}}
\]</div>
<p>This seems quite reasonable, but notice that none of the measures that we’ve discussed so far are attempting to estimate this new quantity. It might just be my own ignorance of the topic, but I’m only aware of one version of Cohen’s <span class="math notranslate nohighlight">\(d\)</span> that actually estimates the unequal-variance effect size <span class="math notranslate nohighlight">\(\delta^\prime\)</span> rather than the equal-variance effect size <span class="math notranslate nohighlight">\(\delta\)</span>.
All we do to calculate <span class="math notranslate nohighlight">\(d\)</span> for this version is substitute the sample means <span class="math notranslate nohighlight">\(\bar{X}_1\)</span> and <span class="math notranslate nohighlight">\(\bar{X}_2\)</span> and the corrected sample standard deviations <span class="math notranslate nohighlight">\(\hat{\sigma}_1\)</span> and <span class="math notranslate nohighlight">\(\hat{\sigma}_2\)</span> into the equation for <span class="math notranslate nohighlight">\(\delta^\prime\)</span>. This gives us the following equation for <span class="math notranslate nohighlight">\(d\)</span>,</p>
<div class="math notranslate nohighlight">
\[
d = \frac{\bar{X}_1 - \bar{X}_2}{\sqrt{\displaystyle{\frac{ {\hat\sigma_1}^2 + {\hat\sigma_2}^2}{2}}}}
\]</div>
<p>as our estimate of the effect size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># find mean student grade for each tutor</span>
<span class="n">u1</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">tutor1</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">tutor2</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>

<span class="c1"># find variance in students&#39; grades for each tutor</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="n">tutor1</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="n">tutor2</span><span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">])</span>


<span class="c1"># find the mean variance of the two samples</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># calculate Cohen&#39;s d</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">u1</span> <span class="o">-</span> <span class="n">u2</span><span class="p">)</span> <span class="o">/</span> <span class="n">s</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7486295728919304
</pre></div>
</div>
</div>
</div>
</section>
<section id="cohen-s-d-from-a-paired-samples-test">
<h3><span class="section-number">14.7.4. </span>Cohen’s <span class="math notranslate nohighlight">\(d\)</span> from a paired-samples test<a class="headerlink" href="#cohen-s-d-from-a-paired-samples-test" title="Permalink to this heading">#</a></h3>
<p>Finally, what should we do for a paired samples <span class="math notranslate nohighlight">\(t\)</span>-test? In this case, the answer depends on what it is you’re trying to do. <em>If</em> you want to measure your effect sizes relative to the distribution of difference scores, the measure of <span class="math notranslate nohighlight">\(d\)</span> that you calculate is just</p>
<div class="math notranslate nohighlight">
\[
d = \frac{\bar{D}}{\hat{\sigma}_D}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{\sigma}_D\)</span> is the estimate of the standard deviation of the differences. The calculation here is pretty straightforward</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/chico.csv&quot;</span><span class="p">)</span>

<span class="n">difference</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test2&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test1&#39;</span><span class="p">]</span>
<span class="n">mean_diff</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">difference</span><span class="p">)</span>
<span class="n">sd_diff</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="n">difference</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">mean_diff</span><span class="o">/</span><span class="n">sd_diff</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.4855669223382983
</pre></div>
</div>
</div>
</div>
<p>The only wrinkle is figuring out whether this is the measure you want or not. To the extent that you care about the practical consequences of your research, you often want to measure the effect size relative to the <em>original</em> variables, not the <em>difference</em> scores (e.g., the 1% improvement in Dr Chico’s class is pretty small when measured against the amount of between-student variation in grades), in which case you use the same versions of Cohen’s <span class="math notranslate nohighlight">\(d\)</span> that you would use for a Student or Welch test. For instance, when we do that for Dr Chico’s class,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># find mean student grade for each tutor</span>
<span class="n">u1</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test1&#39;</span><span class="p">])</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test2&#39;</span><span class="p">])</span>

<span class="c1"># find variance in students&#39; grades for each tutor</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test1&#39;</span><span class="p">])</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;grade_test2&#39;</span><span class="p">])</span>


<span class="c1"># find the mean variance of the two samples</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">s1</span> <span class="o">+</span> <span class="n">s2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># calculate Cohen&#39;s d</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">u2</span> <span class="o">-</span> <span class="n">u1</span><span class="p">)</span> <span class="o">/</span> <span class="n">s</span>
<span class="n">d</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.2213698410715347
</pre></div>
</div>
</div>
</div>
<p>what we see is that the overall effect size is quite small, when assessed on the scale of the original variables.</p>
</section>
</section>
<section id="checking-the-normality-of-a-sample">
<span id="shapiro"></span><h2><span class="section-number">14.8. </span>Checking the normality of a sample<a class="headerlink" href="#checking-the-normality-of-a-sample" title="Permalink to this heading">#</a></h2>
<p>All of the tests that we have discussed so far in this chapter have assumed that the data are normally distributed. This assumption is often quite reasonable, because the central limit theorem (Section &#64;ref(clt)) does tend to ensure that many real world quantities are normally distributed: any time that you suspect that your variable is <em>actually</em> an average of lots of different things, there’s a pretty good chance that it will be normally distributed; or at least close enough to normal that you can get away with using <span class="math notranslate nohighlight">\(t\)</span>-tests. However, life doesn’t come with guarantees; and besides, there are lots of ways in which you can end up with variables that are highly non-normal. For example, any time you think that your variable is actually the minimum of lots of different things, there’s a very good chance it will end up quite skewed. In psychology, response time (RT) data is a good example of this. If you suppose that there are lots of things that could trigger a response from a human participant, then the actual response will occur the first time one of these trigger events occurs.<a class="footnote-reference brackets" href="#note13" id="id20" role="doc-noteref"><span class="fn-bracket">[</span>14<span class="fn-bracket">]</span></a> This means that RT data are systematically non-normal.  Okay, so if normality is assumed by all the tests, and is mostly but not always satisfied (at least approximately) by real world data, how can we check the normality of a sample? In this section I discuss two methods: QQ plots, and the Shapiro-Wilk test.</p>
<section id="qq-plots">
<h3><span class="section-number">14.8.1. </span>QQ plots<a class="headerlink" href="#qq-plots" title="Permalink to this heading">#</a></h3>
<p>One way to check whether a sample violates the normality assumption is to draw a <strong><em>“quantile-quantile” plot</em></strong> (QQ plot). This allows you to visually check whether you’re seeing any systematic violations. In a QQ plot, each observation is plotted as a single dot. The x co-ordinate is the theoretical quantile that the observation should fall in, if the data were normally distributed (with mean and variance estimated from the sample) and on the y co-ordinate is the actual quantile of the data within the sample. If the data are normal, the dots should form a straight line. For instance, lets see what happens if we generate data by sampling from a normal distribution, and then drawing a QQ plot, using <code class="docutils literal notranslate"><span class="pre">probplot</span></code> from <code class="docutils literal notranslate"><span class="pre">scipy</span></code>. We can compare this with a histogram of the data as well:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">probplot</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">normal_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">qq</span> <span class="o">=</span> <span class="n">probplot</span><span class="p">(</span><span class="n">normal_data</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">plot</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">)</span>
<span class="n">hist</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">normal_data</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;qq_fig&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/595c75eca1a9023f2eec1aaf2e7d675d39708f89f135b1a4ee9c1c60a2afe922.png" src="_images/595c75eca1a9023f2eec1aaf2e7d675d39708f89f135b1a4ee9c1c60a2afe922.png" />
</div>
</div>
<figure class="align-default" id="fig-qq" style="width: 600px">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;grades&#39;, ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<figcaption>
<p><span class="caption-number">Fig. 14.1 </span><span class="caption-text">QQ plot (left) and histogram (right) of <code class="docutils literal notranslate"><span class="pre">normal_data</span></code>, a normally distributed sample with 100 observations. The Shapiro-Wilk statistic associated with these data is <span class="math notranslate nohighlight">\(W = .99\)</span>, indicating that no significant departures from normality were detected (<span class="math notranslate nohighlight">\(p = .73\)</span>).</span><a class="headerlink" href="#fig-qq" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>And the results are shown in {numref}(<code class="docutils literal notranslate"><span class="pre">fig-qq</span></code>), above.</p>
<p>As you can see, these data form a pretty straight line; which is no surprise given that we sampled them from a normal distribution! In contrast, have a look at the data shown in {numref}(qqskew) and {numref}(qqheavy), which show the histogram and a QQ plot for a data sets that are highly skewed and have a heavy tail (i.e., high kurtosis), respectively.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/skewed_data.csv&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">qq</span> <span class="o">=</span> <span class="n">probplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">plot</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">)</span>
<span class="n">hist</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;qqskew_fig&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/577184491893125b61ce1160315b2ec76284bb3059f0ba1730c0fcb686087469.png" src="_images/577184491893125b61ce1160315b2ec76284bb3059f0ba1730c0fcb686087469.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/heavy_tailed_data.csv&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">qq</span> <span class="o">=</span> <span class="n">probplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">plot</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">)</span>
<span class="n">hist</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;qqheavy_fig&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/b0fcc922abc276c3231b520e40781516a5db08a25ed2fb9bfa866c61290401c5.png" src="_images/b0fcc922abc276c3231b520e40781516a5db08a25ed2fb9bfa866c61290401c5.png" />
</div>
</div>
<figure class="align-default" id="fig-qqheavy" style="width: 600px">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;grades&#39;, ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<figcaption>
<p><span class="caption-number">Fig. 14.2 </span><span class="caption-text">Plots for a heavy tailed data set, again consisting of 100 observations. In this case, the heavy tails in the data produce a high kurtosis (2.80), and cause the QQ plot to flatten in the middle, and curve away sharply on either side. The resulting Shapiro-Wilk statistic is <span class="math notranslate nohighlight">\(W = .93\)</span>, again reflecting significant non-normality (<span class="math notranslate nohighlight">\(p &lt; .001\)</span>).</span><a class="headerlink" href="#fig-qqheavy" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="shapiro-wilk-tests">
<span id="shapiro-wilk"></span><h3><span class="section-number">14.8.2. </span>Shapiro-Wilk tests<a class="headerlink" href="#shapiro-wilk-tests" title="Permalink to this heading">#</a></h3>
<p>Although QQ plots provide a nice way to informally check the normality of your data, sometimes you’ll want to do something a bit more formal. And when that moment comes, the <strong><em>Shapiro-Wilk test</em></strong> [&#64;Shapiro1965] is probably what you’re looking for.<a class="footnote-reference brackets" href="#note14" id="id21" role="doc-noteref"><span class="fn-bracket">[</span>15<span class="fn-bracket">]</span></a> As you’d expect, the null hypothesis being tested is that a set of <span class="math notranslate nohighlight">\(N\)</span> observations is normally distributed. The test statistic that it calculates is conventionally denoted as <span class="math notranslate nohighlight">\(W\)</span>, and it’s calculated as follows. First, we sort the observations in order of increasing size, and let <span class="math notranslate nohighlight">\(X_1\)</span> be the smallest value in the sample, <span class="math notranslate nohighlight">\(X_2\)</span> be the second smallest and so on. Then the value of <span class="math notranslate nohighlight">\(W\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
W = \frac{ \left( \sum_{i = 1}^N a_i X_i \right)^2 }{ \sum_{i = 1}^N (X_i - \bar{X})^2}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{X}\)</span> is the mean of the observations, and the <span class="math notranslate nohighlight">\(a_i\)</span> values are … mumble, mumble … something complicated that is a bit beyond the scope of an introductory text.</p>
<p>Because it’s a little hard to explain the maths behind the <span class="math notranslate nohighlight">\(W\)</span> statistic, a better idea is to give a broad brush description of how it behaves. Unlike most of the test statistics that we’ll encounter in this book, it’s actually <em>small</em> values of <span class="math notranslate nohighlight">\(W\)</span> that indicated departure from normality. The <span class="math notranslate nohighlight">\(W\)</span> statistic has a maximum value of 1, which arises when the data look “perfectly normal”. The smaller the value of <span class="math notranslate nohighlight">\(W\)</span>, the less normal the data are. However, the sampling distribution for <span class="math notranslate nohighlight">\(W\)</span>  – which is not one of the standard ones that I discussed in Chapter &#64;ref(probability) and is in fact a complete pain in the arse to work with – does depend on the sample size <span class="math notranslate nohighlight">\(N\)</span>. To give you a feel for what these sampling distributions look like, I’ve plotted three of them in Figure &#64;ref(fig:swdist). Notice that, as the sample size starts to get large, the sampling distribution becomes very tightly clumped up near <span class="math notranslate nohighlight">\(W=1\)</span>, and as a consequence, for larger samples <span class="math notranslate nohighlight">\(W\)</span> doesn’t have to be very much smaller than 1 in order for the test to be significant.</p>
<figure class="align-center" id="fig-shapirowilk">
<a class="reference internal image-reference" href="_images/shapirowilkdist.png"><img alt="_images/shapirowilkdist.png" src="_images/shapirowilkdist.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14.3 </span><span class="caption-text">Sampling distribution of the Shapiro-Wilk <span class="math notranslate nohighlight">\(W\)</span> statistic, under the null hypothesis that the data are normally distributed, for samples of size 10, 20 and 50. Note that <em>small</em> values of <span class="math notranslate nohighlight">\(W\)</span> indicate departure from normality.</span><a class="headerlink" href="#fig-shapirowilk" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>To run the test in Python, we use the <code class="docutils literal notranslate"><span class="pre">scipy.stats.shapiro</span></code> method. It has only a single argument <code class="docutils literal notranslate"><span class="pre">x</span></code>, which is a numeric vector containing the data whose normality needs to be tested. For example, when we apply this function to  our <code class="docutils literal notranslate"><span class="pre">normal_data</span></code>, we get the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">shapiro</span>

<span class="n">shapiro</span><span class="p">(</span><span class="n">normal_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ShapiroResult(statistic=0.9898834228515625, pvalue=0.6551706790924072)
</pre></div>
</div>
</div>
</div>
<p>So, not surprisingly, we have no evidence that these data depart from normality. When reporting the results for a Shapiro-Wilk test, you should (as usual) make sure to include the test statistic <span class="math notranslate nohighlight">\(W\)</span> and the <span class="math notranslate nohighlight">\(p\)</span> value, though given that the sampling distribution depends so heavily on <span class="math notranslate nohighlight">\(N\)</span> it would probably be a politeness to include <span class="math notranslate nohighlight">\(N\)</span> as well.</p>
</section>
</section>
<section id="testing-non-normal-data-with-wilcoxon-tests">
<span id="wilcox"></span><h2><span class="section-number">14.9. </span>Testing non-normal data with Wilcoxon tests<a class="headerlink" href="#testing-non-normal-data-with-wilcoxon-tests" title="Permalink to this heading">#</a></h2>
<p>Okay, suppose your data turn out to be pretty substantially non-normal, but you still want to run something like a <span class="math notranslate nohighlight">\(t\)</span>-test? This situation occurs a lot in real life: for the AFL winning margins data, for instance, the Shapiro-Wilk test made it very clear that the normality assumption is violated. This is the situation where you want to use Wilcoxon tests.</p>
<p>Like the <span class="math notranslate nohighlight">\(t\)</span>-test, the Wilcoxon test comes in two forms, one-sample and two-sample, and they’re used in more or less the exact same situations as the corresponding <span class="math notranslate nohighlight">\(t\)</span>-tests. Unlike the <span class="math notranslate nohighlight">\(t\)</span>-test, the Wilcoxon test doesn’t assume normality, which is nice. In fact, they don’t make any assumptions about what kind of distribution is involved: in statistical jargon, this makes them <strong><em>nonparametric tests</em></strong>. While avoiding the normality assumption is nice, there’s a drawback: the Wilcoxon test is usually less powerful than the <span class="math notranslate nohighlight">\(t\)</span>-test (i.e., higher Type II error rate). I won’t discuss the Wilcoxon tests in as much detail as the <span class="math notranslate nohighlight">\(t\)</span>-tests, but I’ll give you a brief overview.</p>
<section id="two-sample-wilcoxon-test">
<h3><span class="section-number">14.9.1. </span>Two sample Wilcoxon test<a class="headerlink" href="#two-sample-wilcoxon-test" title="Permalink to this heading">#</a></h3>
<p>I’ll start by describing the <strong><em>two sample Wilcoxon test</em></strong> (also known as the Mann-Whitney test), since it’s actually simpler than the one sample version. Suppose we’re looking at the scores of 10 people on some test. Since my imagination has now failed me completely, let’s pretend it’s a “test of awesomeness”, and there are two groups of people, “A” and “B”. I’m curious to know which group is more awesome. The data are included in the file <code class="docutils literal notranslate"><span class="pre">awesome.Rdata</span></code>, and like many of the data sets I’ve been using, it contains only a single data frame, in this case called <code class="docutils literal notranslate"><span class="pre">awesome</span></code>. Here’s the data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/awesome2.csv&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>score_A</th>
      <th>score_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.4</td>
      <td>14.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.7</td>
      <td>10.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11.9</td>
      <td>12.9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.3</td>
      <td>11.7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10.0</td>
      <td>13.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>As long as there are no ties (i.e., people with the exact same awesomeness score), then the test that we want to do is surprisingly simple. All we have to do is construct a table that compares every observation in group <span class="math notranslate nohighlight">\(A\)</span> against every observation in group <span class="math notranslate nohighlight">\(B\)</span>. Whenever the group <span class="math notranslate nohighlight">\(A\)</span> datum is larger, we place a check mark in the table:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p>group B</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p></p></td>
<td><p></p></td>
<td><p>14.5</p></td>
<td><p>10.4</p></td>
<td><p>12.4</p></td>
<td><p>11.7</p></td>
<td><p>13</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>6.4</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
</tr>
<tr class="row-even"><td><p>group A</p></td>
<td><p>10.7</p></td>
<td><p>.</p></td>
<td><p>✓</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>11.9</p></td>
<td><p>.</p></td>
<td><p>✓</p></td>
<td><p>.</p></td>
<td><p>✓</p></td>
<td><p>.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>7.3</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>10</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
</tr>
</tbody>
</table>
<p>We then count up the number of checkmarks. This is our test statistic, <span class="math notranslate nohighlight">\(W\)</span>.<a class="footnote-reference brackets" href="#note15" id="id22" role="doc-noteref"><span class="fn-bracket">[</span>16<span class="fn-bracket">]</span></a> The actual sampling distribution for <span class="math notranslate nohighlight">\(W\)</span> is somewhat complicated, and I’ll skip the details. For our purposes, it’s sufficient to note that the interpretation of <span class="math notranslate nohighlight">\(W\)</span> is qualitatively the same as the interpretation of <span class="math notranslate nohighlight">\(t\)</span> or <span class="math notranslate nohighlight">\(z\)</span>. That is, if we want a two-sided test, then we reject the null hypothesis when <span class="math notranslate nohighlight">\(W\)</span> is very large or very small; but if we have a directional (i.e., one-sided) hypothesis, then we only use one or the other.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">wilcoxon</span>
 
<span class="n">w</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="n">wilcoxon</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;score_A&#39;</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;score_B&#39;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">w</span><span class="p">,</span><span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.0, 0.125)
</pre></div>
</div>
</div>
</div>
</section>
<section id="one-sample-wilcoxon-test">
<h3><span class="section-number">14.9.2. </span>One sample Wilcoxon test<a class="headerlink" href="#one-sample-wilcoxon-test" title="Permalink to this heading">#</a></h3>
<p>What about the <strong><em>one sample Wilcoxon test</em></strong> (or equivalently, the paired samples Wilcoxon test)? Suppose I’m interested in finding out whether taking a statistics class has any effect on the happiness of students. Here’s my data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/ethanweed/pythonbook/main/Data/happiness.csv&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>before</th>
      <th>after</th>
      <th>change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>30</td>
      <td>6</td>
      <td>-24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>43</td>
      <td>29</td>
      <td>-14</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21</td>
      <td>11</td>
      <td>-10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>24</td>
      <td>31</td>
      <td>7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>23</td>
      <td>17</td>
      <td>-6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>40</td>
      <td>2</td>
      <td>-38</td>
    </tr>
    <tr>
      <th>6</th>
      <td>29</td>
      <td>31</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>56</td>
      <td>21</td>
      <td>-35</td>
    </tr>
    <tr>
      <th>8</th>
      <td>38</td>
      <td>8</td>
      <td>-30</td>
    </tr>
    <tr>
      <th>9</th>
      <td>16</td>
      <td>21</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>What I’ve measured here is the happiness of each student <code class="docutils literal notranslate"><span class="pre">before</span></code> taking the class and <code class="docutils literal notranslate"><span class="pre">after</span></code> taking the class; the <code class="docutils literal notranslate"><span class="pre">change</span></code> score is the difference between the two. Just like we saw with the <span class="math notranslate nohighlight">\(t\)</span>-test, there’s no fundamental difference between doing a paired-samples test using <code class="docutils literal notranslate"><span class="pre">before</span></code> and <code class="docutils literal notranslate"><span class="pre">after</span></code>, versus doing a one-sample test using the <code class="docutils literal notranslate"><span class="pre">change</span></code> scores. As before, the simplest way to think about the test is to construct a tabulation. The way to do it this time is to take those change scores that are positive valued, and tabulate them against all the complete sample. What you end up with is a table that looks like this:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>all differences</p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
<th class="head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p></p></td>
<td><p></p></td>
<td><p>-24</p></td>
<td><p>-14</p></td>
<td><p>-10</p></td>
<td><p>7</p></td>
<td><p>-6</p></td>
<td><p>-38</p></td>
<td><p>2</p></td>
<td><p>-35</p></td>
<td><p>-30</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>positive differences</p></td>
<td><p>7</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>✓</p></td>
<td><p>✓</p></td>
<td><p>.</p></td>
<td><p>✓</p></td>
<td><p>.</p></td>
<td><p></p></td>
<td><p>✓</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>2</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>✓</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>5</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>✓</p></td>
<td><p>.</p></td>
<td><p>.</p></td>
<td><p>✓</p></td>
</tr>
</tbody>
</table>
<p>Counting up the tick marks this time, we get a test statistic of <span class="math notranslate nohighlight">\(V = 7\)</span>. As before, if our test is two sided, then we reject the null hypothesis when <span class="math notranslate nohighlight">\(V\)</span> is very large or very small. As far of running it with Python goes, it’s pretty much what you’d expect. For the one-sample version, the command you would use is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="n">wilcoxon</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;change&#39;</span><span class="p">])</span>
<span class="n">w</span><span class="p">,</span><span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(7.0, 0.037109375)
</pre></div>
</div>
</div>
</div>
<p>As this shows, we have a significant effect. Evidently, taking a statistics class does have an effect on your happiness.</p>
</section>
</section>
<section id="summary">
<h2><span class="section-number">14.10. </span>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>A one sample <span class="math notranslate nohighlight">\(t\)</span>-test is used to compare a single sample mean against a hypothesised value for the population mean.</p></li>
<li><p>An independent samples <span class="math notranslate nohighlight">\(t\)</span>-test is used to compare the means of two groups, and tests the null hypothesis that they have the same mean. It comes in two forms: the Student test (Section &#64;ref(studentttest) assumes that the groups have the same standard deviation, the Welch test does not.</p></li>
<li><p>A paired samples <span class="math notranslate nohighlight">\(t\)</span>-test is used when you have two scores from each person, and you want to test the null hypothesis that the two scores have the same mean. It is equivalent to taking the difference between the two scores for each person, and then running a one sample <span class="math notranslate nohighlight">\(t\)</span>-test on the difference scores.</p></li>
<li><p>Effect size calculations for the difference between means can be calculated via the Cohen’s <span class="math notranslate nohighlight">\(d\)</span> statistic..</p></li>
<li><p>You can check the normality of a sample using QQ plots and the Shapiro-Wilk test.</p></li>
<li><p>If your data are non-normal, you can use Wilcoxon tests instead of <span class="math notranslate nohighlight">\(t\)</span>-tests.</p></li>
</ul>
<hr class="footnotes docutils" />
<aside class="footnote brackets" id="note1" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>We won’t cover multiple predictors until the chapter on <a class="reference internal" href="05.04-regression.html#regression"><span class="std std-ref">regression</span></a>.</p>
</aside>
<aside class="footnote brackets" id="note2" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>Informal experimentation in my garden suggests that yes, it does. Australian natives are adapted to low phosphorus levels relative to everywhere else on Earth, apparently, so if you’ve bought a house with a bunch of exotics and you want to plant natives, don’t follow my example: keep them separate. Nutrients to European plants are poison to Australian ones. There’s probably a joke in that, but I can’t figure out what it is.</p>
</aside>
<aside class="footnote brackets" id="note3" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p>Actually this is too strong. Strictly speaking the <span class="math notranslate nohighlight">\(z\)</span> test only requires that the sampling distribution of the mean be normally distributed; if the population is normal then it necessarily follows that the sampling distribution of the mean is also normal. However, as we saw when talking about the central limit theorem, it’s quite possible (even commonplace) for the sampling distribution to be normal even if the population distribution itself is non-normal. However, in light of the sheer ridiculousness of the assumption that the true standard deviation is known, there really isn’t much point in going into details on this front!</p>
</aside>
<aside class="footnote brackets" id="note4" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p>Well, sort of. As I understand the history, Gosset only provided a partial solution: the general solution to the problem was provided by Sir Ronald Fisher.</p>
</aside>
<aside class="footnote brackets" id="note5" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">5</a><span class="fn-bracket">]</span></span>
<p>More seriously, I tend to think the reverse is true: I get very suspicious of technical reports that fill their results sections with nothing except the numbers. It might just be that I’m an arrogant jerk, but I often feel like an author that makes no attempt to explain and interpret their analysis to the reader either doesn’t understand it themselves, or is being a bit lazy. Your readers are smart, but not infinitely patient. Don’t annoy them if you can help it.</p>
</aside>
<aside class="footnote brackets" id="note-normality" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">6</a><span class="fn-bracket">]</span></span>
<p>A technical comment… in the same way that we can weaken the assumptions of the <span class="math notranslate nohighlight">\(z\)</span>-test so that we’re only talking about the sampling distribution, we <em>can</em> weaken the <span class="math notranslate nohighlight">\(t\)</span> test assumptions so that we don’t have to assume normality of the population. However, for the <span class="math notranslate nohighlight">\(t\)</span>-test, it’s trickier to do this. As before, we can replace the assumption of population normality with an assumption that the sampling distribution of <span class="math notranslate nohighlight">\(\bar{X}\)</span> is normal. However, remember that we’re also relying on a sample estimate of the standard deviation; and so we also require the sampling distribution of <span class="math notranslate nohighlight">\(\hat{\sigma}\)</span> to be chi-square. That makes things nastier, and this version is rarely used in practice: fortunately, if the population is normal, then both of these two assumptions are met., and as noted earlier, there are <a class="reference internal" href="#shapiro"><span class="std std-ref">standard tools</span></a> that you can use to check to see if this assumption is met, and <a class="reference internal" href="#wilcox"><span class="std std-ref">other tests</span></a> you can do in it’s place if this assumption is violated.</p>
</aside>
<aside class="footnote brackets" id="note6" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">7</a><span class="fn-bracket">]</span></span>
<p>Although it is the simplest, which is why I started with it.</p>
</aside>
<aside class="footnote brackets" id="note7" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">8</a><span class="fn-bracket">]</span></span>
<p>A funny question almost always pops up at this point: what the heck <em>is</em> the population being referred to in this case? Is it the set of students actually taking Dr Harpo’s class (all 33 of them)? The set of people who might take the class (an unknown number) of them? Or something else? Does it matter which of these we pick? It’s traditional in an introductory behavioural stats class to mumble a lot at this point, but since I get asked this question every year by my students, I’ll give a brief answer. Technically yes, it does matter: if you change your definition of what the “real world” population actually is, then the sampling distribution of your observed mean <span class="math notranslate nohighlight">\(\bar{X}\)</span> changes too. The <span class="math notranslate nohighlight">\(t\)</span>-test relies on an assumption that the observations are sampled at random from an infinitely large population; and to the extent that real life isn’t like that, then the <span class="math notranslate nohighlight">\(t\)</span>-test can be wrong. In practice, however, this isn’t usually a big deal: even though the assumption is almost always wrong, it doesn’t lead to a lot of pathological behaviour from the test, so we tend to just ignore it.</p>
</aside>
<aside class="footnote brackets" id="note8" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">9</a><span class="fn-bracket">]</span></span>
<p>Yes, I  have a “favourite” way of thinking about pooled standard deviation estimates. So what?</p>
</aside>
<aside class="footnote brackets" id="note9" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id12">10</a><span class="fn-bracket">]</span></span>
<p>Well, I guess you can average apples and oranges, and what you end up with is a delicious fruit smoothie. But no one really thinks that a fruit smoothie is a very good way to describe the original fruits, do they?</p>
</aside>
<aside class="footnote brackets" id="note10" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id15">11</a><span class="fn-bracket">]</span></span>
<p>This design is very similar to the one in <a class="reference internal" href="05.01-chisquare.html#chisquare"><span class="std std-ref">Categorical data analysis</span></a> that motivated the McNemar test. This should be no surprise. Both are standard repeated measures designs involving two measurements. The only difference is that this time our outcome variable is interval scale (working memory capacity) rather than a binary, nominal scale variable (a yes-or-no question).</p>
</aside>
<aside class="footnote brackets" id="note11" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id17">12</a><span class="fn-bracket">]</span></span>
<p>At this point we have Drs Harpo, Chico and Zeppo. No prizes for guessing who Dr Groucho is.</p>
</aside>
<aside class="footnote brackets" id="note12" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id18">13</a><span class="fn-bracket">]</span></span>
<p>This is obviously a class being taught at a very small or very expensive university, or else is a postgraduate class. <em>I’ve</em> never taught an intro stats class with less than 350 students.</p>
</aside>
<aside class="footnote brackets" id="note13" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id20">14</a><span class="fn-bracket">]</span></span>
<p>This is a massive oversimplification.</p>
</aside>
<aside class="footnote brackets" id="note14" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id21">15</a><span class="fn-bracket">]</span></span>
<p>Either that, or the Kolmogorov-Smirnov test, which is probably more traditional than the Shapiro-Wilk, though most things I’ve read seem to suggest Shapiro-Wilk is the better test of normality, although Kolomogorov-Smirnov is a general purpose test of distributional equivalence, so it can be adapted to handle other kinds of distribution tests.</p>
</aside>
<aside class="footnote brackets" id="note15" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id22">16</a><span class="fn-bracket">]</span></span>
<p>Actually, there are two different versions of the test statistic; they differ from each other by a constant value. I’ll just describe one of them here.</p>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="05.01-chisquare.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">13. </span>Categorical data analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="05.03-anova.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">15. </span>Comparing several means</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-one-sample-z-test">14.1. The one-sample <span class="math notranslate nohighlight">\(z\)</span>-test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-inference-problem-that-the-test-addresses">14.1.1. The inference problem that the test addresses</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-the-hypothesis-test">14.1.2. Constructing the hypothesis test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-worked-example-using-python">14.1.3. A worked example using Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-of-the-z-test">14.1.4. Assumptions of the <span class="math notranslate nohighlight">\(z\)</span>-test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-one-sample-t-test">14.2. The one-sample <span class="math notranslate nohighlight">\(t\)</span>-test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-the-t-test">14.2.1. Introducing the <span class="math notranslate nohighlight">\(t\)</span>-test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#doing-the-test-in-python">14.2.2. Doing the test in Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-of-the-one-sample-t-test">14.2.3. Assumptions of the one sample <span class="math notranslate nohighlight">\(t\)</span>-test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-independent-samples-t-test-student-test">14.3. The independent samples <span class="math notranslate nohighlight">\(t\)</span>-test (Student test)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data">14.3.1. The data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introducing-the-test">14.3.2. Introducing the test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-pooled-estimate-of-the-standard-deviation">14.3.3. A “pooled estimate” of the standard deviation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-same-pooled-estimate-described-differently">14.3.4. The same pooled estimate, described differently</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#completing-the-test">14.3.5. Completing the test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">14.3.6. Doing the test in Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#positive-and-negative-t-values">14.3.7. Positive and negative <span class="math notranslate nohighlight">\(t\)</span> values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-of-the-test">14.3.8. Assumptions of the test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-independent-samples-t-test-welch-test">14.4. The independent samples <span class="math notranslate nohighlight">\(t\)</span>-test (Welch test)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">14.4.1. Doing the test in Python</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">14.4.2. Assumptions of the test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-paired-samples-t-test">14.5. The paired-samples <span class="math notranslate nohighlight">\(t\)</span>-test</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">14.5.1. The data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-paired-samples-t-test">14.5.2. What is the paired samples <span class="math notranslate nohighlight">\(t\)</span>-test?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">14.5.3. Doing the test in Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sided-tests">14.6. One sided tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#effect-size">14.7. Effect size</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohen-s-d-from-one-sample">14.7.1. Cohen’s <span class="math notranslate nohighlight">\(d\)</span> from one sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohen-s-d-from-a-student-t-test">14.7.2. Cohen’s <span class="math notranslate nohighlight">\(d\)</span> from a Student <span class="math notranslate nohighlight">\(t\)</span> test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohen-s-d-from-a-welch-test">14.7.3. Cohen’s <span class="math notranslate nohighlight">\(d\)</span> from a Welch test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cohen-s-d-from-a-paired-samples-test">14.7.4. Cohen’s <span class="math notranslate nohighlight">\(d\)</span> from a paired-samples test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-the-normality-of-a-sample">14.8. Checking the normality of a sample</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#qq-plots">14.8.1. QQ plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shapiro-wilk-tests">14.8.2. Shapiro-Wilk tests</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-non-normal-data-with-wilcoxon-tests">14.9. Testing non-normal data with Wilcoxon tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-sample-wilcoxon-test">14.9.1. Two sample Wilcoxon test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-sample-wilcoxon-test">14.9.2. One sample Wilcoxon test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">14.10. Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Danielle Navarro and Ethan Weed
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>